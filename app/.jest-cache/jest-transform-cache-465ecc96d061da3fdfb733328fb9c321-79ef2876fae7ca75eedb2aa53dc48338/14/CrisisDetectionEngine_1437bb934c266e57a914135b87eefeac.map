{"version":3,"names":["_reactNative","require","_asyncStorage","_interopRequireDefault","SecureStore","_interopRequireWildcard","CLINICAL_CRISIS_THRESHOLDS","exports","PHQ9_CRISIS_SCORE","GAD7_CRISIS_SCORE","PHQ9_SUICIDAL_QUESTION_ID","SUICIDAL_IDEATION_THRESHOLD","MAX_DETECTION_TIME_MS","MAX_INTERVENTION_TIME_MS","MIN_INTERVENTION_DURATION_MS","CRISIS_SEVERITY_MATRIX","phq9","suicidal_ideation","low_score","high_score","severe_score","moderate_severe","gad7","moderate_score","CrisisDetectionEngine","_classCallCheck2","default","performanceMetrics","Map","activeInterventions","_createClass2","key","value","_detectCrisis","_asyncToGenerator2","result","userId","assessmentId","detectionStartTime","performance","now","detection","initializeCrisisDetection","recordPerformanceMetric","isValid","validateCrisisDetection","console","error","logCrisisDetection","emergencyDetection","createEmergencyFailsafe","detectCrisis","_x","_x2","_x3","apply","arguments","_triggerCrisisIntervention","interventionStartTime","intervention","initializeCrisisIntervention","set","id","displayCrisisIntervention","logCrisisIntervention","emergencyFailsafeIntervention","triggerCrisisIntervention","_x4","_detectSuicidalIdeation","questionId","response","Date","Math","random","toString","substr","isTriggered","primaryTrigger","secondaryTriggers","severityLevel","triggerValue","assessmentType","timestamp","detectionResponseTimeMs","context","triggeringAnswers","timeOfDay","getTimeOfDay","detectSuicidalIdeation","_x5","_x6","_x7","_x8","_captureCrisisData","actions","crisisDataPackage","captureTimestamp","detectionTime","interventionTime","responseTime","totalCrisisTime","userSafetyStatus","determineSafetyStatus","followUpRequired","determineFollowUpRequirements","auditTrail","generateAuditTrail","storeCrisisData","captureCrisisData","_x9","_x0","_x1","getPerformanceMetrics","metrics","Object","fromEntries","assign","detection_time_violations","detection_max","intervention_time_violations","intervention_max","total_crisis_episodes","size","performance_status","getPerformanceStatus","_displayCrisisIntervention","displayEmergencyCrisisAlert","displayHighCrisisAlert","displayModerateCrisisAlert","_x10","_displayEmergencyCrisisAlert","_this","Alert","alert","text","onPress","recordCrisisAction","Linking","openURL","style","cancelable","_x11","_displayHighCrisisAlert","_this2","_x12","_displayModerateCrisisAlert","_this3","_x13","_initializeCrisisDetection","startTime","triggers","suicidalIdeation","push","totalScore","length","filter","t","answers","_x14","_x15","_x16","_x17","interventionId","interventionStarted","startTimestamp","contactedSupport","status","actionsTaken","followUp","required","urgency","determineFollowUpUrgency","type","recommendations","generateFollowUpRecommendations","contacts","completed","canDismiss","dismissalAvailableAt","detectionId","action","get","metric","duration","currentMax","currentCount","max","hour","getHours","includes","_logCrisisDetection","logEntry","source","AsyncStorage","setItem","JSON","stringify","_x18","_logCrisisIntervention","_x19","_storeCrisisData","dataPackage","encrypted","setItemAsync","_x20","_generateAuditTrail","toISOString","_x21","getInstance","instance","_default"],"sources":["CrisisDetectionEngine.ts"],"sourcesContent":["/**\n * CRISIS DETECTION ENGINE - DRD-FLOW-005 Comprehensive Safety Foundation\n *\n * CLINICAL REQUIREMENTS:\n * - PHQ-9 â‰¥20 = Severe Depression Crisis\n * - GAD-7 â‰¥15 = Severe Anxiety Crisis\n * - PHQ-9 Question 9 >0 = Suicidal Ideation (IMMEDIATE INTERVENTION)\n * - Detection response time <200ms (CRITICAL)\n * - Intervention display <3 taps to 988\n * - 100% clinical accuracy (regulatory requirement)\n *\n * SAFETY PROTOCOLS:\n * - Multi-level crisis severity assessment\n * - Real-time intervention orchestration\n * - Encrypted crisis data capture with audit\n * - Performance monitoring and alerting\n * - Fail-safe mechanisms for system errors\n *\n * Week 2 Orchestration Plan - Safety Foundation\n */\n\nimport { Alert, Linking } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport * as SecureStore from 'expo-secure-store';\nimport type {\n  PHQ9Result,\n  GAD7Result,\n  AssessmentType,\n  CrisisDetection,\n  CrisisIntervention,\n  CrisisTriggerType,\n  CrisisSeverityLevel,\n  CrisisActionType,\n  CrisisResource\n} from '../flows/assessment/types';\n\n/**\n * CLINICAL CRISIS THRESHOLDS - IMMUTABLE\n * These values MUST NOT be modified - clinically validated\n */\nexport const CLINICAL_CRISIS_THRESHOLDS = {\n  /** PHQ-9 Severe Depression Score */\n  PHQ9_CRISIS_SCORE: 20,\n  /** GAD-7 Severe Anxiety Score */\n  GAD7_CRISIS_SCORE: 15,\n  /** PHQ-9 Suicidal Ideation Question */\n  PHQ9_SUICIDAL_QUESTION_ID: 'phq9_9',\n  /** Any suicidal ideation response triggers crisis */\n  SUICIDAL_IDEATION_THRESHOLD: 0,\n  /** Maximum crisis detection time (ms) */\n  MAX_DETECTION_TIME_MS: 200,\n  /** Maximum intervention display time (ms) */\n  MAX_INTERVENTION_TIME_MS: 3000,\n  /** Minimum intervention duration before dismissal */\n  MIN_INTERVENTION_DURATION_MS: 30000,\n} as const;\n\n/**\n * CRISIS SEVERITY MATRIX\n * Clinical decision tree for crisis intervention level\n */\nconst CRISIS_SEVERITY_MATRIX = {\n  phq9: {\n    suicidal_ideation: {\n      low_score: 'critical',      // Q9 >0, score <20\n      high_score: 'emergency'     // Q9 >0, score â‰¥20\n    },\n    severe_score: 'high',         // Score â‰¥20, no suicidal ideation\n    moderate_severe: 'moderate'   // Score 15-19\n  },\n  gad7: {\n    severe_score: 'high',         // Score â‰¥15\n    moderate_score: 'moderate'    // Score 10-14\n  }\n} as const;\n\n/**\n * CRISIS DETECTION ENGINE\n * Core class for comprehensive crisis detection and intervention\n */\nexport class CrisisDetectionEngine {\n  private static instance: CrisisDetectionEngine;\n  private performanceMetrics: Map<string, number> = new Map();\n  private activeInterventions: Map<string, CrisisIntervention> = new Map();\n\n  private constructor() {}\n\n  public static getInstance(): CrisisDetectionEngine {\n    if (!CrisisDetectionEngine.instance) {\n      CrisisDetectionEngine.instance = new CrisisDetectionEngine();\n    }\n    return CrisisDetectionEngine.instance;\n  }\n\n  /**\n   * PRIMARY CRISIS DETECTION\n   * Analyzes assessment results for crisis conditions\n   * PERFORMANCE REQUIREMENT: <200ms\n   */\n  public async detectCrisis(\n    result: PHQ9Result | GAD7Result,\n    userId: string,\n    assessmentId: string\n  ): Promise<CrisisDetection | null> {\n    const detectionStartTime = performance.now();\n\n    try {\n      // Initialize detection context\n      const detection = await this.initializeCrisisDetection(\n        result,\n        userId,\n        assessmentId,\n        detectionStartTime\n      );\n\n      // No crisis detected\n      if (!detection) {\n        this.recordPerformanceMetric('detection_no_crisis', detectionStartTime);\n        return null;\n      }\n\n      // Validate detection meets safety requirements\n      const isValid = this.validateCrisisDetection(detection);\n      if (!isValid) {\n        console.error('ðŸš¨ CRISIS DETECTION VALIDATION FAILED', detection);\n        // Fail-safe: Still trigger intervention for user safety\n      }\n\n      // Record performance metrics\n      this.recordPerformanceMetric('detection_crisis_found', detectionStartTime);\n\n      // Log crisis detection for audit\n      await this.logCrisisDetection(detection);\n\n      return detection;\n\n    } catch (error) {\n      console.error('ðŸš¨ CRISIS DETECTION ENGINE ERROR:', error);\n\n      // FAIL-SAFE: Create emergency detection for any system error\n      const emergencyDetection = this.createEmergencyFailsafe(\n        result,\n        userId,\n        assessmentId,\n        detectionStartTime\n      );\n\n      await this.logCrisisDetection(emergencyDetection);\n      return emergencyDetection;\n    }\n  }\n\n  /**\n   * CRISIS INTERVENTION ORCHESTRATION\n   * Manages complete intervention workflow\n   * PERFORMANCE REQUIREMENT: <3 seconds to 988 access\n   */\n  public async triggerCrisisIntervention(\n    detection: CrisisDetection\n  ): Promise<CrisisIntervention> {\n    const interventionStartTime = performance.now();\n\n    try {\n      // Create intervention session\n      const intervention = this.initializeCrisisIntervention(\n        detection,\n        interventionStartTime\n      );\n\n      // Store active intervention\n      this.activeInterventions.set(detection.id, intervention);\n\n      // Trigger immediate UI intervention based on severity\n      await this.displayCrisisIntervention(intervention);\n\n      // Log intervention start\n      await this.logCrisisIntervention(intervention);\n\n      // Record performance\n      this.recordPerformanceMetric('intervention_triggered', interventionStartTime);\n\n      return intervention;\n\n    } catch (error) {\n      console.error('ðŸš¨ CRISIS INTERVENTION ERROR:', error);\n\n      // FAIL-SAFE: Direct 988 call\n      this.emergencyFailsafeIntervention();\n\n      throw error;\n    }\n  }\n\n  /**\n   * REAL-TIME SUICIDAL IDEATION DETECTION\n   * Immediate intervention for PHQ-9 Question 9\n   */\n  public async detectSuicidalIdeation(\n    questionId: string,\n    response: number,\n    userId: string,\n    assessmentId: string\n  ): Promise<CrisisDetection | null> {\n    const detectionStartTime = performance.now();\n\n    // Check if this is PHQ-9 Question 9 (suicidal ideation)\n    if (questionId !== CLINICAL_CRISIS_THRESHOLDS.PHQ9_SUICIDAL_QUESTION_ID) {\n      return null;\n    }\n\n    // Any response >0 indicates suicidal ideation\n    if (response <= CLINICAL_CRISIS_THRESHOLDS.SUICIDAL_IDEATION_THRESHOLD) {\n      return null;\n    }\n\n    try {\n      const detection: CrisisDetection = {\n        id: `suicidal_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        isTriggered: true,\n        primaryTrigger: 'phq9_suicidal_ideation',\n        secondaryTriggers: [],\n        severityLevel: 'critical', // Always critical for suicidal ideation\n        triggerValue: response,\n        assessmentType: 'phq9',\n        timestamp: Date.now(),\n        assessmentId,\n        userId,\n        detectionResponseTimeMs: performance.now() - detectionStartTime,\n        context: {\n          triggeringAnswers: [{\n            questionId,\n            response,\n            timestamp: Date.now()\n          }],\n          timeOfDay: this.getTimeOfDay()\n        }\n      };\n\n      // Immediate intervention for suicidal ideation\n      await this.triggerCrisisIntervention(detection);\n\n      return detection;\n\n    } catch (error) {\n      console.error('ðŸš¨ SUICIDAL IDEATION DETECTION ERROR:', error);\n\n      // FAIL-SAFE: Emergency intervention\n      this.emergencyFailsafeIntervention();\n      return null;\n    }\n  }\n\n  /**\n   * CRISIS DATA CAPTURE\n   * Comprehensive data collection for clinical records\n   */\n  public async captureCrisisData(\n    detection: CrisisDetection,\n    intervention: CrisisIntervention,\n    actions: CrisisActionType[]\n  ): Promise<void> {\n    try {\n      const crisisDataPackage = {\n        detection,\n        intervention,\n        actions,\n        captureTimestamp: Date.now(),\n        performanceMetrics: {\n          detectionTime: detection.detectionResponseTimeMs,\n          interventionTime: intervention.responseTime,\n          totalCrisisTime: Date.now() - detection.timestamp\n        },\n        userSafetyStatus: this.determineSafetyStatus(actions),\n        followUpRequired: this.determineFollowUpRequirements(detection, actions),\n        auditTrail: await this.generateAuditTrail(detection.id)\n      };\n\n      // Encrypted storage for clinical data\n      await this.storeCrisisData(crisisDataPackage);\n\n      // Performance monitoring\n      this.recordPerformanceMetric('data_capture_complete', performance.now());\n\n    } catch (error) {\n      console.error('ðŸš¨ CRISIS DATA CAPTURE ERROR:', error);\n      // Continue - don't fail intervention for data capture errors\n    }\n  }\n\n  /**\n   * PERFORMANCE MONITORING\n   * Real-time performance tracking and alerting\n   */\n  public getPerformanceMetrics(): Record<string, number> {\n    const metrics = Object.fromEntries(this.performanceMetrics);\n\n    // Add threshold validations\n    return {\n      ...metrics,\n      detection_time_violations: metrics.detection_max > CLINICAL_CRISIS_THRESHOLDS.MAX_DETECTION_TIME_MS ? 1 : 0,\n      intervention_time_violations: metrics.intervention_max > CLINICAL_CRISIS_THRESHOLDS.MAX_INTERVENTION_TIME_MS ? 1 : 0,\n      total_crisis_episodes: this.activeInterventions.size,\n      performance_status: this.getPerformanceStatus(metrics)\n    };\n  }\n\n  /**\n   * CRISIS INTERVENTION WORKFLOW\n   * Step-by-step crisis response procedures\n   */\n  private async displayCrisisIntervention(intervention: CrisisIntervention): Promise<void> {\n    const { detection } = intervention;\n\n    try {\n      switch (detection.severityLevel) {\n        case 'emergency':\n        case 'critical':\n          await this.displayEmergencyCrisisAlert(detection);\n          break;\n        case 'high':\n          await this.displayHighCrisisAlert(detection);\n          break;\n        case 'moderate':\n          await this.displayModerateCrisisAlert(detection);\n          break;\n      }\n    } catch (error) {\n      console.error('ðŸš¨ CRISIS INTERVENTION DISPLAY ERROR:', error);\n      // Fail-safe: Basic emergency alert\n      this.emergencyFailsafeIntervention();\n    }\n  }\n\n  private async displayEmergencyCrisisAlert(detection: CrisisDetection): Promise<void> {\n    Alert.alert(\n      'ðŸš¨ IMMEDIATE CRISIS SUPPORT',\n      'Your responses indicate you may be in immediate danger. Crisis support is available 24/7. You are not alone.',\n      [\n        {\n          text: 'Call 988 Now',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'contacted_988');\n            Linking.openURL('tel:988');\n          },\n          style: 'default'\n        },\n        {\n          text: 'Emergency 911',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'contacted_emergency');\n            Linking.openURL('tel:911');\n          },\n          style: 'destructive'\n        },\n        {\n          text: 'Crisis Text',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'contacted_support');\n            Linking.openURL('sms:741741');\n          },\n          style: 'default'\n        }\n      ],\n      { cancelable: false }\n    );\n  }\n\n  private async displayHighCrisisAlert(detection: CrisisDetection): Promise<void> {\n    Alert.alert(\n      'ðŸš¨ Crisis Support Available',\n      'Your responses suggest you may benefit from immediate professional support. Help is available 24/7.',\n      [\n        {\n          text: 'Call 988 (Crisis Line)',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'contacted_988');\n            Linking.openURL('tel:988');\n          },\n          style: 'default'\n        },\n        {\n          text: 'Text Crisis Support',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'contacted_support');\n            Linking.openURL('sms:741741');\n          },\n          style: 'default'\n        },\n        {\n          text: 'View Resources',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'viewed_resources');\n            // Navigate to crisis resources screen\n          },\n          style: 'cancel'\n        }\n      ],\n      { cancelable: false }\n    );\n  }\n\n  private async displayModerateCrisisAlert(detection: CrisisDetection): Promise<void> {\n    Alert.alert(\n      'Support Available',\n      'Your assessment indicates you may benefit from professional support. Would you like to explore available resources?',\n      [\n        {\n          text: 'Call 988',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'contacted_988');\n            Linking.openURL('tel:988');\n          },\n          style: 'default'\n        },\n        {\n          text: 'View Resources',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'viewed_resources');\n            // Navigate to resources\n          },\n          style: 'default'\n        },\n        {\n          text: 'Continue',\n          onPress: () => {\n            this.recordCrisisAction(detection.id, 'acknowledged_safety');\n          },\n          style: 'cancel'\n        }\n      ]\n    );\n  }\n\n  /**\n   * HELPER METHODS\n   */\n\n  private async initializeCrisisDetection(\n    result: PHQ9Result | GAD7Result,\n    userId: string,\n    assessmentId: string,\n    startTime: number\n  ): Promise<CrisisDetection | null> {\n    const triggers: CrisisTriggerType[] = [];\n    let severityLevel: CrisisSeverityLevel = 'moderate';\n    let primaryTrigger: CrisisTriggerType | null = null;\n\n    // PHQ-9 Crisis Analysis\n    if ('suicidalIdeation' in result) {\n      if (result.suicidalIdeation) {\n        triggers.push('phq9_suicidal_ideation');\n        primaryTrigger = 'phq9_suicidal_ideation';\n        severityLevel = result.totalScore >= CLINICAL_CRISIS_THRESHOLDS.PHQ9_CRISIS_SCORE\n          ? 'emergency'\n          : 'critical';\n      }\n\n      if (result.totalScore >= CLINICAL_CRISIS_THRESHOLDS.PHQ9_CRISIS_SCORE) {\n        triggers.push('phq9_severe_score');\n        if (!primaryTrigger) {\n          primaryTrigger = 'phq9_severe_score';\n          severityLevel = 'high';\n        }\n      }\n    }\n    // GAD-7 Crisis Analysis\n    else {\n      if (result.totalScore >= CLINICAL_CRISIS_THRESHOLDS.GAD7_CRISIS_SCORE) {\n        triggers.push('gad7_severe_score');\n        primaryTrigger = 'gad7_severe_score';\n        severityLevel = 'high';\n      }\n    }\n\n    // No crisis detected\n    if (triggers.length === 0) {\n      return null;\n    }\n\n    return {\n      id: `crisis_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      isTriggered: true,\n      primaryTrigger: primaryTrigger!,\n      secondaryTriggers: triggers.filter(t => t !== primaryTrigger),\n      severityLevel,\n      triggerValue: result.totalScore,\n      assessmentType: 'suicidalIdeation' in result ? 'phq9' : 'gad7',\n      timestamp: Date.now(),\n      assessmentId,\n      userId,\n      detectionResponseTimeMs: performance.now() - startTime,\n      context: {\n        triggeringAnswers: result.answers,\n        timeOfDay: this.getTimeOfDay()\n      }\n    };\n  }\n\n  private initializeCrisisIntervention(\n    detection: CrisisDetection,\n    startTime: number\n  ): CrisisIntervention {\n    return {\n      detection,\n      interventionId: `intervention_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      interventionStarted: true,\n      startTimestamp: Date.now(),\n      contactedSupport: false,\n      responseTime: performance.now() - startTime,\n      status: 'initiated',\n      actionsTaken: [],\n      followUp: {\n        required: true,\n        urgency: this.determineFollowUpUrgency(detection),\n        type: 'clinical_assessment',\n        recommendations: this.generateFollowUpRecommendations(detection),\n        contacts: [],\n        completed: false\n      },\n      canDismiss: false,\n      dismissalAvailableAt: Date.now() + CLINICAL_CRISIS_THRESHOLDS.MIN_INTERVENTION_DURATION_MS\n    };\n  }\n\n  private validateCrisisDetection(detection: CrisisDetection): boolean {\n    // Validate response time\n    if (detection.detectionResponseTimeMs > CLINICAL_CRISIS_THRESHOLDS.MAX_DETECTION_TIME_MS) {\n      return false;\n    }\n\n    // Validate trigger conditions match thresholds\n    if (detection.primaryTrigger === 'phq9_severe_score' &&\n        detection.triggerValue < CLINICAL_CRISIS_THRESHOLDS.PHQ9_CRISIS_SCORE) {\n      return false;\n    }\n\n    if (detection.primaryTrigger === 'gad7_severe_score' &&\n        detection.triggerValue < CLINICAL_CRISIS_THRESHOLDS.GAD7_CRISIS_SCORE) {\n      return false;\n    }\n\n    return true;\n  }\n\n  private createEmergencyFailsafe(\n    result: PHQ9Result | GAD7Result,\n    userId: string,\n    assessmentId: string,\n    startTime: number\n  ): CrisisDetection {\n    return {\n      id: `emergency_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      isTriggered: true,\n      primaryTrigger: 'manual_override',\n      secondaryTriggers: [],\n      severityLevel: 'emergency',\n      triggerValue: result.totalScore,\n      assessmentType: 'suicidalIdeation' in result ? 'phq9' : 'gad7',\n      timestamp: Date.now(),\n      assessmentId,\n      userId,\n      detectionResponseTimeMs: performance.now() - startTime,\n      context: {\n        triggeringAnswers: result.answers,\n        timeOfDay: this.getTimeOfDay()\n      }\n    };\n  }\n\n  private emergencyFailsafeIntervention(): void {\n    Alert.alert(\n      'ðŸš¨ Emergency Support',\n      'Crisis support is available immediately.',\n      [\n        {\n          text: 'Call 988 Now',\n          onPress: () => Linking.openURL('tel:988'),\n          style: 'default'\n        }\n      ],\n      { cancelable: false }\n    );\n  }\n\n  private recordCrisisAction(detectionId: string, action: CrisisActionType): void {\n    const intervention = this.activeInterventions.get(detectionId);\n    if (intervention) {\n      intervention.actionsTaken.push({\n        type: action,\n        timestamp: Date.now(),\n        completed: true\n      });\n    }\n  }\n\n  private recordPerformanceMetric(metric: string, startTime: number): void {\n    const duration = performance.now() - startTime;\n    const currentMax = this.performanceMetrics.get(`${metric}_max`) || 0;\n    const currentCount = this.performanceMetrics.get(`${metric}_count`) || 0;\n\n    this.performanceMetrics.set(`${metric}_max`, Math.max(currentMax, duration));\n    this.performanceMetrics.set(`${metric}_count`, currentCount + 1);\n    this.performanceMetrics.set(`${metric}_last`, duration);\n  }\n\n  private getTimeOfDay(): 'morning' | 'afternoon' | 'evening' | 'night' {\n    const hour = new Date().getHours();\n    if (hour >= 6 && hour < 12) return 'morning';\n    if (hour >= 12 && hour < 17) return 'afternoon';\n    if (hour >= 17 && hour < 21) return 'evening';\n    return 'night';\n  }\n\n  private determineFollowUpUrgency(detection: CrisisDetection): 'immediate' | 'within_24h' | 'within_48h' | 'within_week' {\n    switch (detection.severityLevel) {\n      case 'emergency':\n      case 'critical':\n        return 'immediate';\n      case 'high':\n        return 'within_24h';\n      case 'moderate':\n        return 'within_48h';\n      default:\n        return 'within_week';\n    }\n  }\n\n  private generateFollowUpRecommendations(detection: CrisisDetection): string[] {\n    const recommendations = [];\n\n    if (detection.primaryTrigger === 'phq9_suicidal_ideation') {\n      recommendations.push('Immediate clinical assessment for suicide risk');\n      recommendations.push('Safety planning with mental health professional');\n      recommendations.push('Consider inpatient evaluation if risk persists');\n    }\n\n    if (detection.severityLevel === 'high' || detection.severityLevel === 'critical') {\n      recommendations.push('Schedule appointment with mental health provider within 24-48 hours');\n      recommendations.push('Consider medication evaluation');\n      recommendations.push('Engage support network and remove potential means');\n    }\n\n    recommendations.push('Follow up on crisis intervention outcome');\n    recommendations.push('Monitor for ongoing safety and symptom changes');\n\n    return recommendations;\n  }\n\n  private determineSafetyStatus(actions: CrisisActionType[]): 'safe' | 'monitoring_required' | 'professional_care_needed' {\n    if (actions.includes('contacted_emergency') || actions.includes('contacted_988')) {\n      return 'professional_care_needed';\n    }\n    if (actions.includes('contacted_support') || actions.includes('activated_safety_plan')) {\n      return 'monitoring_required';\n    }\n    return 'safe';\n  }\n\n  private determineFollowUpRequirements(detection: CrisisDetection, actions: CrisisActionType[]): boolean {\n    return detection.severityLevel === 'critical' ||\n           detection.severityLevel === 'emergency' ||\n           detection.primaryTrigger === 'phq9_suicidal_ideation';\n  }\n\n  private getPerformanceStatus(metrics: Record<string, number>): 'optimal' | 'acceptable' | 'concerning' | 'critical' {\n    const detectionTime = metrics.detection_max || 0;\n    const interventionTime = metrics.intervention_max || 0;\n\n    if (detectionTime > CLINICAL_CRISIS_THRESHOLDS.MAX_DETECTION_TIME_MS * 2 ||\n        interventionTime > CLINICAL_CRISIS_THRESHOLDS.MAX_INTERVENTION_TIME_MS * 2) {\n      return 'critical';\n    }\n\n    if (detectionTime > CLINICAL_CRISIS_THRESHOLDS.MAX_DETECTION_TIME_MS ||\n        interventionTime > CLINICAL_CRISIS_THRESHOLDS.MAX_INTERVENTION_TIME_MS) {\n      return 'concerning';\n    }\n\n    if (detectionTime > CLINICAL_CRISIS_THRESHOLDS.MAX_DETECTION_TIME_MS * 0.5) {\n      return 'acceptable';\n    }\n\n    return 'optimal';\n  }\n\n  private async logCrisisDetection(detection: CrisisDetection): Promise<void> {\n    try {\n      const logEntry = {\n        type: 'crisis_detection',\n        detection,\n        timestamp: Date.now(),\n        source: 'CrisisDetectionEngine'\n      };\n\n      await AsyncStorage.setItem(\n        `crisis_detection_${detection.id}`,\n        JSON.stringify(logEntry)\n      );\n    } catch (error) {\n      console.error('Crisis detection logging failed:', error);\n    }\n  }\n\n  private async logCrisisIntervention(intervention: CrisisIntervention): Promise<void> {\n    try {\n      const logEntry = {\n        type: 'crisis_intervention',\n        intervention,\n        timestamp: Date.now(),\n        source: 'CrisisDetectionEngine'\n      };\n\n      await AsyncStorage.setItem(\n        `crisis_intervention_${intervention.interventionId}`,\n        JSON.stringify(logEntry)\n      );\n    } catch (error) {\n      console.error('Crisis intervention logging failed:', error);\n    }\n  }\n\n  private async storeCrisisData(dataPackage: any): Promise<void> {\n    try {\n      const encrypted = JSON.stringify(dataPackage);\n      await SecureStore.setItemAsync(\n        `crisis_data_${dataPackage.detection.id}`,\n        encrypted\n      );\n    } catch (error) {\n      console.error('Crisis data storage failed:', error);\n    }\n  }\n\n  private async generateAuditTrail(detectionId: string): Promise<string[]> {\n    // Generate comprehensive audit trail for clinical compliance\n    return [\n      `Crisis detection initiated: ${new Date().toISOString()}`,\n      `Detection ID: ${detectionId}`,\n      `Engine version: DRD-FLOW-005`,\n      `Clinical thresholds validated: PHQ-9â‰¥20, GAD-7â‰¥15, PHQ-9-Q9>0`\n    ];\n  }\n}\n\n// Export singleton instance\nexport default CrisisDetectionEngine.getInstance();"],"mappings":";;;;;;;;;AAqBA,IAAAA,YAAA,GAAAC,OAAA;AACA,IAAAC,aAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,WAAA,GAAAC,uBAAA,CAAAJ,OAAA;AAiBO,IAAMK,0BAA0B,GAAAC,OAAA,CAAAD,0BAAA,GAAG;EAExCE,iBAAiB,EAAE,EAAE;EAErBC,iBAAiB,EAAE,EAAE;EAErBC,yBAAyB,EAAE,QAAQ;EAEnCC,2BAA2B,EAAE,CAAC;EAE9BC,qBAAqB,EAAE,GAAG;EAE1BC,wBAAwB,EAAE,IAAI;EAE9BC,4BAA4B,EAAE;AAChC,CAAU;AAMV,IAAMC,sBAAsB,GAAG;EAC7BC,IAAI,EAAE;IACJC,iBAAiB,EAAE;MACjBC,SAAS,EAAE,UAAU;MACrBC,UAAU,EAAE;IACd,CAAC;IACDC,YAAY,EAAE,MAAM;IACpBC,eAAe,EAAE;EACnB,CAAC;EACDC,IAAI,EAAE;IACJF,YAAY,EAAE,MAAM;IACpBG,cAAc,EAAE;EAClB;AACF,CAAU;AAAC,IAMEC,qBAAqB,GAAAjB,OAAA,CAAAiB,qBAAA;EAKhC,SAAAA,sBAAA,EAAsB;IAAA,IAAAC,gBAAA,CAAAC,OAAA,QAAAF,qBAAA;IAAA,KAHdG,kBAAkB,GAAwB,IAAIC,GAAG,CAAC,CAAC;IAAA,KACnDC,mBAAmB,GAAoC,IAAID,GAAG,CAAC,CAAC;EAEjD;EAAC,WAAAE,aAAA,CAAAJ,OAAA,EAAAF,qBAAA;IAAAO,GAAA;IAAAC,KAAA;MAAA,IAAAC,aAAA,OAAAC,kBAAA,CAAAR,OAAA,EAcxB,WACES,MAA+B,EAC/BC,MAAc,EACdC,YAAoB,EACa;QACjC,IAAMC,kBAAkB,GAAGC,WAAW,CAACC,GAAG,CAAC,CAAC;QAE5C,IAAI;UAEF,IAAMC,SAAS,SAAS,IAAI,CAACC,yBAAyB,CACpDP,MAAM,EACNC,MAAM,EACNC,YAAY,EACZC,kBACF,CAAC;UAGD,IAAI,CAACG,SAAS,EAAE;YACd,IAAI,CAACE,uBAAuB,CAAC,qBAAqB,EAAEL,kBAAkB,CAAC;YACvE,OAAO,IAAI;UACb;UAGA,IAAMM,OAAO,GAAG,IAAI,CAACC,uBAAuB,CAACJ,SAAS,CAAC;UACvD,IAAI,CAACG,OAAO,EAAE;YACZE,OAAO,CAACC,KAAK,CAAC,uCAAuC,EAAEN,SAAS,CAAC;UAEnE;UAGA,IAAI,CAACE,uBAAuB,CAAC,wBAAwB,EAAEL,kBAAkB,CAAC;UAG1E,MAAM,IAAI,CAACU,kBAAkB,CAACP,SAAS,CAAC;UAExC,OAAOA,SAAS;QAElB,CAAC,CAAC,OAAOM,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;UAGzD,IAAME,kBAAkB,GAAG,IAAI,CAACC,uBAAuB,CACrDf,MAAM,EACNC,MAAM,EACNC,YAAY,EACZC,kBACF,CAAC;UAED,MAAM,IAAI,CAACU,kBAAkB,CAACC,kBAAkB,CAAC;UACjD,OAAOA,kBAAkB;QAC3B;MACF,CAAC;MAAA,SAnDYE,YAAYA,CAAAC,EAAA,EAAAC,GAAA,EAAAC,GAAA;QAAA,OAAArB,aAAA,CAAAsB,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAZL,YAAY;IAAA;EAAA;IAAApB,GAAA;IAAAC,KAAA;MAAA,IAAAyB,0BAAA,OAAAvB,kBAAA,CAAAR,OAAA,EA0DzB,WACEe,SAA0B,EACG;QAC7B,IAAMiB,qBAAqB,GAAGnB,WAAW,CAACC,GAAG,CAAC,CAAC;QAE/C,IAAI;UAEF,IAAMmB,YAAY,GAAG,IAAI,CAACC,4BAA4B,CACpDnB,SAAS,EACTiB,qBACF,CAAC;UAGD,IAAI,CAAC7B,mBAAmB,CAACgC,GAAG,CAACpB,SAAS,CAACqB,EAAE,EAAEH,YAAY,CAAC;UAGxD,MAAM,IAAI,CAACI,yBAAyB,CAACJ,YAAY,CAAC;UAGlD,MAAM,IAAI,CAACK,qBAAqB,CAACL,YAAY,CAAC;UAG9C,IAAI,CAAChB,uBAAuB,CAAC,wBAAwB,EAAEe,qBAAqB,CAAC;UAE7E,OAAOC,YAAY;QAErB,CAAC,CAAC,OAAOZ,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;UAGrD,IAAI,CAACkB,6BAA6B,CAAC,CAAC;UAEpC,MAAMlB,KAAK;QACb;MACF,CAAC;MAAA,SAlCYmB,yBAAyBA,CAAAC,GAAA;QAAA,OAAAV,0BAAA,CAAAF,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAzBU,yBAAyB;IAAA;EAAA;IAAAnC,GAAA;IAAAC,KAAA;MAAA,IAAAoC,uBAAA,OAAAlC,kBAAA,CAAAR,OAAA,EAwCtC,WACE2C,UAAkB,EAClBC,QAAgB,EAChBlC,MAAc,EACdC,YAAoB,EACa;QACjC,IAAMC,kBAAkB,GAAGC,WAAW,CAACC,GAAG,CAAC,CAAC;QAG5C,IAAI6B,UAAU,KAAK/D,0BAA0B,CAACI,yBAAyB,EAAE;UACvE,OAAO,IAAI;QACb;QAGA,IAAI4D,QAAQ,IAAIhE,0BAA0B,CAACK,2BAA2B,EAAE;UACtE,OAAO,IAAI;QACb;QAEA,IAAI;UACF,IAAM8B,SAA0B,GAAG;YACjCqB,EAAE,EAAE,YAAYS,IAAI,CAAC/B,GAAG,CAAC,CAAC,IAAIgC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;YACvEC,WAAW,EAAE,IAAI;YACjBC,cAAc,EAAE,wBAAwB;YACxCC,iBAAiB,EAAE,EAAE;YACrBC,aAAa,EAAE,UAAU;YACzBC,YAAY,EAAEV,QAAQ;YACtBW,cAAc,EAAE,MAAM;YACtBC,SAAS,EAAEX,IAAI,CAAC/B,GAAG,CAAC,CAAC;YACrBH,YAAY,EAAZA,YAAY;YACZD,MAAM,EAANA,MAAM;YACN+C,uBAAuB,EAAE5C,WAAW,CAACC,GAAG,CAAC,CAAC,GAAGF,kBAAkB;YAC/D8C,OAAO,EAAE;cACPC,iBAAiB,EAAE,CAAC;gBAClBhB,UAAU,EAAVA,UAAU;gBACVC,QAAQ,EAARA,QAAQ;gBACRY,SAAS,EAAEX,IAAI,CAAC/B,GAAG,CAAC;cACtB,CAAC,CAAC;cACF8C,SAAS,EAAE,IAAI,CAACC,YAAY,CAAC;YAC/B;UACF,CAAC;UAGD,MAAM,IAAI,CAACrB,yBAAyB,CAACzB,SAAS,CAAC;UAE/C,OAAOA,SAAS;QAElB,CAAC,CAAC,OAAOM,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,uCAAuC,EAAEA,KAAK,CAAC;UAG7D,IAAI,CAACkB,6BAA6B,CAAC,CAAC;UACpC,OAAO,IAAI;QACb;MACF,CAAC;MAAA,SArDYuB,sBAAsBA,CAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAxB,uBAAA,CAAAb,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAtBgC,sBAAsB;IAAA;EAAA;IAAAzD,GAAA;IAAAC,KAAA;MAAA,IAAA6D,kBAAA,OAAA3D,kBAAA,CAAAR,OAAA,EA2DnC,WACEe,SAA0B,EAC1BkB,YAAgC,EAChCmC,OAA2B,EACZ;QACf,IAAI;UACF,IAAMC,iBAAiB,GAAG;YACxBtD,SAAS,EAATA,SAAS;YACTkB,YAAY,EAAZA,YAAY;YACZmC,OAAO,EAAPA,OAAO;YACPE,gBAAgB,EAAEzB,IAAI,CAAC/B,GAAG,CAAC,CAAC;YAC5Bb,kBAAkB,EAAE;cAClBsE,aAAa,EAAExD,SAAS,CAAC0C,uBAAuB;cAChDe,gBAAgB,EAAEvC,YAAY,CAACwC,YAAY;cAC3CC,eAAe,EAAE7B,IAAI,CAAC/B,GAAG,CAAC,CAAC,GAAGC,SAAS,CAACyC;YAC1C,CAAC;YACDmB,gBAAgB,EAAE,IAAI,CAACC,qBAAqB,CAACR,OAAO,CAAC;YACrDS,gBAAgB,EAAE,IAAI,CAACC,6BAA6B,CAAC/D,SAAS,EAAEqD,OAAO,CAAC;YACxEW,UAAU,QAAQ,IAAI,CAACC,kBAAkB,CAACjE,SAAS,CAACqB,EAAE;UACxD,CAAC;UAGD,MAAM,IAAI,CAAC6C,eAAe,CAACZ,iBAAiB,CAAC;UAG7C,IAAI,CAACpD,uBAAuB,CAAC,uBAAuB,EAAEJ,WAAW,CAACC,GAAG,CAAC,CAAC,CAAC;QAE1E,CAAC,CAAC,OAAOO,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;QAEvD;MACF,CAAC;MAAA,SA/BY6D,iBAAiBA,CAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAlB,kBAAA,CAAAtC,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAjBoD,iBAAiB;IAAA;EAAA;IAAA7E,GAAA;IAAAC,KAAA,EAqC9B,SAAOgF,qBAAqBA,CAAA,EAA2B;MACrD,IAAMC,OAAO,GAAGC,MAAM,CAACC,WAAW,CAAC,IAAI,CAACxF,kBAAkB,CAAC;MAG3D,OAAAuF,MAAA,CAAAE,MAAA,KACKH,OAAO;QACVI,yBAAyB,EAAEJ,OAAO,CAACK,aAAa,GAAGhH,0BAA0B,CAACM,qBAAqB,GAAG,CAAC,GAAG,CAAC;QAC3G2G,4BAA4B,EAAEN,OAAO,CAACO,gBAAgB,GAAGlH,0BAA0B,CAACO,wBAAwB,GAAG,CAAC,GAAG,CAAC;QACpH4G,qBAAqB,EAAE,IAAI,CAAC5F,mBAAmB,CAAC6F,IAAI;QACpDC,kBAAkB,EAAE,IAAI,CAACC,oBAAoB,CAACX,OAAO;MAAC;IAE1D;EAAC;IAAAlF,GAAA;IAAAC,KAAA;MAAA,IAAA6F,0BAAA,OAAA3F,kBAAA,CAAAR,OAAA,EAMD,WAAwCiC,YAAgC,EAAiB;QACvF,IAAQlB,SAAS,GAAKkB,YAAY,CAA1BlB,SAAS;QAEjB,IAAI;UACF,QAAQA,SAAS,CAACsC,aAAa;YAC7B,KAAK,WAAW;YAChB,KAAK,UAAU;cACb,MAAM,IAAI,CAAC+C,2BAA2B,CAACrF,SAAS,CAAC;cACjD;YACF,KAAK,MAAM;cACT,MAAM,IAAI,CAACsF,sBAAsB,CAACtF,SAAS,CAAC;cAC5C;YACF,KAAK,UAAU;cACb,MAAM,IAAI,CAACuF,0BAA0B,CAACvF,SAAS,CAAC;cAChD;UACJ;QACF,CAAC,CAAC,OAAOM,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,uCAAuC,EAAEA,KAAK,CAAC;UAE7D,IAAI,CAACkB,6BAA6B,CAAC,CAAC;QACtC;MACF,CAAC;MAAA,SArBaF,yBAAyBA,CAAAkE,IAAA;QAAA,OAAAJ,0BAAA,CAAAtE,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAzBO,yBAAyB;IAAA;EAAA;IAAAhC,GAAA;IAAAC,KAAA;MAAA,IAAAkG,4BAAA,OAAAhG,kBAAA,CAAAR,OAAA,EAuBvC,WAA0Ce,SAA0B,EAAiB;QAAA,IAAA0F,KAAA;QACnFC,kBAAK,CAACC,KAAK,CACT,6BAA6B,EAC7B,8GAA8G,EAC9G,CACE;UACEC,IAAI,EAAE,cAAc;UACpBC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbJ,KAAI,CAACK,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,eAAe,CAAC;YACtD2E,oBAAO,CAACC,OAAO,CAAC,SAAS,CAAC;UAC5B,CAAC;UACDC,KAAK,EAAE;QACT,CAAC,EACD;UACEL,IAAI,EAAE,eAAe;UACrBC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbJ,KAAI,CAACK,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,qBAAqB,CAAC;YAC5D2E,oBAAO,CAACC,OAAO,CAAC,SAAS,CAAC;UAC5B,CAAC;UACDC,KAAK,EAAE;QACT,CAAC,EACD;UACEL,IAAI,EAAE,aAAa;UACnBC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbJ,KAAI,CAACK,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,mBAAmB,CAAC;YAC1D2E,oBAAO,CAACC,OAAO,CAAC,YAAY,CAAC;UAC/B,CAAC;UACDC,KAAK,EAAE;QACT,CAAC,CACF,EACD;UAAEC,UAAU,EAAE;QAAM,CACtB,CAAC;MACH,CAAC;MAAA,SAhCad,2BAA2BA,CAAAe,IAAA;QAAA,OAAAX,4BAAA,CAAA3E,KAAA,OAAAC,SAAA;MAAA;MAAA,OAA3BsE,2BAA2B;IAAA;EAAA;IAAA/F,GAAA;IAAAC,KAAA;MAAA,IAAA8G,uBAAA,OAAA5G,kBAAA,CAAAR,OAAA,EAkCzC,WAAqCe,SAA0B,EAAiB;QAAA,IAAAsG,MAAA;QAC9EX,kBAAK,CAACC,KAAK,CACT,6BAA6B,EAC7B,qGAAqG,EACrG,CACE;UACEC,IAAI,EAAE,wBAAwB;UAC9BC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbQ,MAAI,CAACP,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,eAAe,CAAC;YACtD2E,oBAAO,CAACC,OAAO,CAAC,SAAS,CAAC;UAC5B,CAAC;UACDC,KAAK,EAAE;QACT,CAAC,EACD;UACEL,IAAI,EAAE,qBAAqB;UAC3BC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbQ,MAAI,CAACP,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,mBAAmB,CAAC;YAC1D2E,oBAAO,CAACC,OAAO,CAAC,YAAY,CAAC;UAC/B,CAAC;UACDC,KAAK,EAAE;QACT,CAAC,EACD;UACEL,IAAI,EAAE,gBAAgB;UACtBC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbQ,MAAI,CAACP,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,kBAAkB,CAAC;UAE3D,CAAC;UACD6E,KAAK,EAAE;QACT,CAAC,CACF,EACD;UAAEC,UAAU,EAAE;QAAM,CACtB,CAAC;MACH,CAAC;MAAA,SAhCab,sBAAsBA,CAAAiB,IAAA;QAAA,OAAAF,uBAAA,CAAAvF,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAtBuE,sBAAsB;IAAA;EAAA;IAAAhG,GAAA;IAAAC,KAAA;MAAA,IAAAiH,2BAAA,OAAA/G,kBAAA,CAAAR,OAAA,EAkCpC,WAAyCe,SAA0B,EAAiB;QAAA,IAAAyG,MAAA;QAClFd,kBAAK,CAACC,KAAK,CACT,mBAAmB,EACnB,qHAAqH,EACrH,CACE;UACEC,IAAI,EAAE,UAAU;UAChBC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbW,MAAI,CAACV,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,eAAe,CAAC;YACtD2E,oBAAO,CAACC,OAAO,CAAC,SAAS,CAAC;UAC5B,CAAC;UACDC,KAAK,EAAE;QACT,CAAC,EACD;UACEL,IAAI,EAAE,gBAAgB;UACtBC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbW,MAAI,CAACV,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,kBAAkB,CAAC;UAE3D,CAAC;UACD6E,KAAK,EAAE;QACT,CAAC,EACD;UACEL,IAAI,EAAE,UAAU;UAChBC,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAQ;YACbW,MAAI,CAACV,kBAAkB,CAAC/F,SAAS,CAACqB,EAAE,EAAE,qBAAqB,CAAC;UAC9D,CAAC;UACD6E,KAAK,EAAE;QACT,CAAC,CAEL,CAAC;MACH,CAAC;MAAA,SA9BaX,0BAA0BA,CAAAmB,IAAA;QAAA,OAAAF,2BAAA,CAAA1F,KAAA,OAAAC,SAAA;MAAA;MAAA,OAA1BwE,0BAA0B;IAAA;EAAA;IAAAjG,GAAA;IAAAC,KAAA;MAAA,IAAAoH,0BAAA,OAAAlH,kBAAA,CAAAR,OAAA,EAoCxC,WACES,MAA+B,EAC/BC,MAAc,EACdC,YAAoB,EACpBgH,SAAiB,EACgB;QACjC,IAAMC,QAA6B,GAAG,EAAE;QACxC,IAAIvE,aAAkC,GAAG,UAAU;QACnD,IAAIF,cAAwC,GAAG,IAAI;QAGnD,IAAI,kBAAkB,IAAI1C,MAAM,EAAE;UAChC,IAAIA,MAAM,CAACoH,gBAAgB,EAAE;YAC3BD,QAAQ,CAACE,IAAI,CAAC,wBAAwB,CAAC;YACvC3E,cAAc,GAAG,wBAAwB;YACzCE,aAAa,GAAG5C,MAAM,CAACsH,UAAU,IAAInJ,0BAA0B,CAACE,iBAAiB,GAC7E,WAAW,GACX,UAAU;UAChB;UAEA,IAAI2B,MAAM,CAACsH,UAAU,IAAInJ,0BAA0B,CAACE,iBAAiB,EAAE;YACrE8I,QAAQ,CAACE,IAAI,CAAC,mBAAmB,CAAC;YAClC,IAAI,CAAC3E,cAAc,EAAE;cACnBA,cAAc,GAAG,mBAAmB;cACpCE,aAAa,GAAG,MAAM;YACxB;UACF;QACF,CAAC,MAEI;UACH,IAAI5C,MAAM,CAACsH,UAAU,IAAInJ,0BAA0B,CAACG,iBAAiB,EAAE;YACrE6I,QAAQ,CAACE,IAAI,CAAC,mBAAmB,CAAC;YAClC3E,cAAc,GAAG,mBAAmB;YACpCE,aAAa,GAAG,MAAM;UACxB;QACF;QAGA,IAAIuE,QAAQ,CAACI,MAAM,KAAK,CAAC,EAAE;UACzB,OAAO,IAAI;QACb;QAEA,OAAO;UACL5F,EAAE,EAAE,UAAUS,IAAI,CAAC/B,GAAG,CAAC,CAAC,IAAIgC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;UACrEC,WAAW,EAAE,IAAI;UACjBC,cAAc,EAAEA,cAAe;UAC/BC,iBAAiB,EAAEwE,QAAQ,CAACK,MAAM,CAAC,UAAAC,CAAC;YAAA,OAAIA,CAAC,KAAK/E,cAAc;UAAA,EAAC;UAC7DE,aAAa,EAAbA,aAAa;UACbC,YAAY,EAAE7C,MAAM,CAACsH,UAAU;UAC/BxE,cAAc,EAAE,kBAAkB,IAAI9C,MAAM,GAAG,MAAM,GAAG,MAAM;UAC9D+C,SAAS,EAAEX,IAAI,CAAC/B,GAAG,CAAC,CAAC;UACrBH,YAAY,EAAZA,YAAY;UACZD,MAAM,EAANA,MAAM;UACN+C,uBAAuB,EAAE5C,WAAW,CAACC,GAAG,CAAC,CAAC,GAAG6G,SAAS;UACtDjE,OAAO,EAAE;YACPC,iBAAiB,EAAElD,MAAM,CAAC0H,OAAO;YACjCvE,SAAS,EAAE,IAAI,CAACC,YAAY,CAAC;UAC/B;QACF,CAAC;MACH,CAAC;MAAA,SA3Da7C,yBAAyBA,CAAAoH,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA;QAAA,OAAAb,0BAAA,CAAA7F,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAzBd,yBAAyB;IAAA;EAAA;IAAAX,GAAA;IAAAC,KAAA,EA6DvC,SAAQ4B,4BAA4BA,CAClCnB,SAA0B,EAC1B4G,SAAiB,EACG;MACpB,OAAO;QACL5G,SAAS,EAATA,SAAS;QACTyH,cAAc,EAAE,gBAAgB3F,IAAI,CAAC/B,GAAG,CAAC,CAAC,IAAIgC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;QACvFwF,mBAAmB,EAAE,IAAI;QACzBC,cAAc,EAAE7F,IAAI,CAAC/B,GAAG,CAAC,CAAC;QAC1B6H,gBAAgB,EAAE,KAAK;QACvBlE,YAAY,EAAE5D,WAAW,CAACC,GAAG,CAAC,CAAC,GAAG6G,SAAS;QAC3CiB,MAAM,EAAE,WAAW;QACnBC,YAAY,EAAE,EAAE;QAChBC,QAAQ,EAAE;UACRC,QAAQ,EAAE,IAAI;UACdC,OAAO,EAAE,IAAI,CAACC,wBAAwB,CAAClI,SAAS,CAAC;UACjDmI,IAAI,EAAE,qBAAqB;UAC3BC,eAAe,EAAE,IAAI,CAACC,+BAA+B,CAACrI,SAAS,CAAC;UAChEsI,QAAQ,EAAE,EAAE;UACZC,SAAS,EAAE;QACb,CAAC;QACDC,UAAU,EAAE,KAAK;QACjBC,oBAAoB,EAAE3G,IAAI,CAAC/B,GAAG,CAAC,CAAC,GAAGlC,0BAA0B,CAACQ;MAChE,CAAC;IACH;EAAC;IAAAiB,GAAA;IAAAC,KAAA,EAED,SAAQa,uBAAuBA,CAACJ,SAA0B,EAAW;MAEnE,IAAIA,SAAS,CAAC0C,uBAAuB,GAAG7E,0BAA0B,CAACM,qBAAqB,EAAE;QACxF,OAAO,KAAK;MACd;MAGA,IAAI6B,SAAS,CAACoC,cAAc,KAAK,mBAAmB,IAChDpC,SAAS,CAACuC,YAAY,GAAG1E,0BAA0B,CAACE,iBAAiB,EAAE;QACzE,OAAO,KAAK;MACd;MAEA,IAAIiC,SAAS,CAACoC,cAAc,KAAK,mBAAmB,IAChDpC,SAAS,CAACuC,YAAY,GAAG1E,0BAA0B,CAACG,iBAAiB,EAAE;QACzE,OAAO,KAAK;MACd;MAEA,OAAO,IAAI;IACb;EAAC;IAAAsB,GAAA;IAAAC,KAAA,EAED,SAAQkB,uBAAuBA,CAC7Bf,MAA+B,EAC/BC,MAAc,EACdC,YAAoB,EACpBgH,SAAiB,EACA;MACjB,OAAO;QACLvF,EAAE,EAAE,aAAaS,IAAI,CAAC/B,GAAG,CAAC,CAAC,IAAIgC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;QACxEC,WAAW,EAAE,IAAI;QACjBC,cAAc,EAAE,iBAAiB;QACjCC,iBAAiB,EAAE,EAAE;QACrBC,aAAa,EAAE,WAAW;QAC1BC,YAAY,EAAE7C,MAAM,CAACsH,UAAU;QAC/BxE,cAAc,EAAE,kBAAkB,IAAI9C,MAAM,GAAG,MAAM,GAAG,MAAM;QAC9D+C,SAAS,EAAEX,IAAI,CAAC/B,GAAG,CAAC,CAAC;QACrBH,YAAY,EAAZA,YAAY;QACZD,MAAM,EAANA,MAAM;QACN+C,uBAAuB,EAAE5C,WAAW,CAACC,GAAG,CAAC,CAAC,GAAG6G,SAAS;QACtDjE,OAAO,EAAE;UACPC,iBAAiB,EAAElD,MAAM,CAAC0H,OAAO;UACjCvE,SAAS,EAAE,IAAI,CAACC,YAAY,CAAC;QAC/B;MACF,CAAC;IACH;EAAC;IAAAxD,GAAA;IAAAC,KAAA,EAED,SAAQiC,6BAA6BA,CAAA,EAAS;MAC5CmE,kBAAK,CAACC,KAAK,CACT,sBAAsB,EACtB,0CAA0C,EAC1C,CACE;QACEC,IAAI,EAAE,cAAc;QACpBC,OAAO,EAAE,SAATA,OAAOA,CAAA;UAAA,OAAQE,oBAAO,CAACC,OAAO,CAAC,SAAS,CAAC;QAAA;QACzCC,KAAK,EAAE;MACT,CAAC,CACF,EACD;QAAEC,UAAU,EAAE;MAAM,CACtB,CAAC;IACH;EAAC;IAAA7G,GAAA;IAAAC,KAAA,EAED,SAAQwG,kBAAkBA,CAAC2C,WAAmB,EAAEC,MAAwB,EAAQ;MAC9E,IAAMzH,YAAY,GAAG,IAAI,CAAC9B,mBAAmB,CAACwJ,GAAG,CAACF,WAAW,CAAC;MAC9D,IAAIxH,YAAY,EAAE;QAChBA,YAAY,CAAC4G,YAAY,CAACf,IAAI,CAAC;UAC7BoB,IAAI,EAAEQ,MAAM;UACZlG,SAAS,EAAEX,IAAI,CAAC/B,GAAG,CAAC,CAAC;UACrBwI,SAAS,EAAE;QACb,CAAC,CAAC;MACJ;IACF;EAAC;IAAAjJ,GAAA;IAAAC,KAAA,EAED,SAAQW,uBAAuBA,CAAC2I,MAAc,EAAEjC,SAAiB,EAAQ;MACvE,IAAMkC,QAAQ,GAAGhJ,WAAW,CAACC,GAAG,CAAC,CAAC,GAAG6G,SAAS;MAC9C,IAAMmC,UAAU,GAAG,IAAI,CAAC7J,kBAAkB,CAAC0J,GAAG,CAAC,GAAGC,MAAM,MAAM,CAAC,IAAI,CAAC;MACpE,IAAMG,YAAY,GAAG,IAAI,CAAC9J,kBAAkB,CAAC0J,GAAG,CAAC,GAAGC,MAAM,QAAQ,CAAC,IAAI,CAAC;MAExE,IAAI,CAAC3J,kBAAkB,CAACkC,GAAG,CAAC,GAAGyH,MAAM,MAAM,EAAE9G,IAAI,CAACkH,GAAG,CAACF,UAAU,EAAED,QAAQ,CAAC,CAAC;MAC5E,IAAI,CAAC5J,kBAAkB,CAACkC,GAAG,CAAC,GAAGyH,MAAM,QAAQ,EAAEG,YAAY,GAAG,CAAC,CAAC;MAChE,IAAI,CAAC9J,kBAAkB,CAACkC,GAAG,CAAC,GAAGyH,MAAM,OAAO,EAAEC,QAAQ,CAAC;IACzD;EAAC;IAAAxJ,GAAA;IAAAC,KAAA,EAED,SAAQuD,YAAYA,CAAA,EAAkD;MACpE,IAAMoG,IAAI,GAAG,IAAIpH,IAAI,CAAC,CAAC,CAACqH,QAAQ,CAAC,CAAC;MAClC,IAAID,IAAI,IAAI,CAAC,IAAIA,IAAI,GAAG,EAAE,EAAE,OAAO,SAAS;MAC5C,IAAIA,IAAI,IAAI,EAAE,IAAIA,IAAI,GAAG,EAAE,EAAE,OAAO,WAAW;MAC/C,IAAIA,IAAI,IAAI,EAAE,IAAIA,IAAI,GAAG,EAAE,EAAE,OAAO,SAAS;MAC7C,OAAO,OAAO;IAChB;EAAC;IAAA5J,GAAA;IAAAC,KAAA,EAED,SAAQ2I,wBAAwBA,CAAClI,SAA0B,EAA6D;MACtH,QAAQA,SAAS,CAACsC,aAAa;QAC7B,KAAK,WAAW;QAChB,KAAK,UAAU;UACb,OAAO,WAAW;QACpB,KAAK,MAAM;UACT,OAAO,YAAY;QACrB,KAAK,UAAU;UACb,OAAO,YAAY;QACrB;UACE,OAAO,aAAa;MACxB;IACF;EAAC;IAAAhD,GAAA;IAAAC,KAAA,EAED,SAAQ8I,+BAA+BA,CAACrI,SAA0B,EAAY;MAC5E,IAAMoI,eAAe,GAAG,EAAE;MAE1B,IAAIpI,SAAS,CAACoC,cAAc,KAAK,wBAAwB,EAAE;QACzDgG,eAAe,CAACrB,IAAI,CAAC,gDAAgD,CAAC;QACtEqB,eAAe,CAACrB,IAAI,CAAC,iDAAiD,CAAC;QACvEqB,eAAe,CAACrB,IAAI,CAAC,gDAAgD,CAAC;MACxE;MAEA,IAAI/G,SAAS,CAACsC,aAAa,KAAK,MAAM,IAAItC,SAAS,CAACsC,aAAa,KAAK,UAAU,EAAE;QAChF8F,eAAe,CAACrB,IAAI,CAAC,qEAAqE,CAAC;QAC3FqB,eAAe,CAACrB,IAAI,CAAC,gCAAgC,CAAC;QACtDqB,eAAe,CAACrB,IAAI,CAAC,mDAAmD,CAAC;MAC3E;MAEAqB,eAAe,CAACrB,IAAI,CAAC,0CAA0C,CAAC;MAChEqB,eAAe,CAACrB,IAAI,CAAC,gDAAgD,CAAC;MAEtE,OAAOqB,eAAe;IACxB;EAAC;IAAA9I,GAAA;IAAAC,KAAA,EAED,SAAQsE,qBAAqBA,CAACR,OAA2B,EAA+D;MACtH,IAAIA,OAAO,CAAC+F,QAAQ,CAAC,qBAAqB,CAAC,IAAI/F,OAAO,CAAC+F,QAAQ,CAAC,eAAe,CAAC,EAAE;QAChF,OAAO,0BAA0B;MACnC;MACA,IAAI/F,OAAO,CAAC+F,QAAQ,CAAC,mBAAmB,CAAC,IAAI/F,OAAO,CAAC+F,QAAQ,CAAC,uBAAuB,CAAC,EAAE;QACtF,OAAO,qBAAqB;MAC9B;MACA,OAAO,MAAM;IACf;EAAC;IAAA9J,GAAA;IAAAC,KAAA,EAED,SAAQwE,6BAA6BA,CAAC/D,SAA0B,EAAEqD,OAA2B,EAAW;MACtG,OAAOrD,SAAS,CAACsC,aAAa,KAAK,UAAU,IACtCtC,SAAS,CAACsC,aAAa,KAAK,WAAW,IACvCtC,SAAS,CAACoC,cAAc,KAAK,wBAAwB;IAC9D;EAAC;IAAA9C,GAAA;IAAAC,KAAA,EAED,SAAQ4F,oBAAoBA,CAACX,OAA+B,EAAwD;MAClH,IAAMhB,aAAa,GAAGgB,OAAO,CAACK,aAAa,IAAI,CAAC;MAChD,IAAMpB,gBAAgB,GAAGe,OAAO,CAACO,gBAAgB,IAAI,CAAC;MAEtD,IAAIvB,aAAa,GAAG3F,0BAA0B,CAACM,qBAAqB,GAAG,CAAC,IACpEsF,gBAAgB,GAAG5F,0BAA0B,CAACO,wBAAwB,GAAG,CAAC,EAAE;QAC9E,OAAO,UAAU;MACnB;MAEA,IAAIoF,aAAa,GAAG3F,0BAA0B,CAACM,qBAAqB,IAChEsF,gBAAgB,GAAG5F,0BAA0B,CAACO,wBAAwB,EAAE;QAC1E,OAAO,YAAY;MACrB;MAEA,IAAIoF,aAAa,GAAG3F,0BAA0B,CAACM,qBAAqB,GAAG,GAAG,EAAE;QAC1E,OAAO,YAAY;MACrB;MAEA,OAAO,SAAS;IAClB;EAAC;IAAAmB,GAAA;IAAAC,KAAA;MAAA,IAAA8J,mBAAA,OAAA5J,kBAAA,CAAAR,OAAA,EAED,WAAiCe,SAA0B,EAAiB;QAC1E,IAAI;UACF,IAAMsJ,QAAQ,GAAG;YACfnB,IAAI,EAAE,kBAAkB;YACxBnI,SAAS,EAATA,SAAS;YACTyC,SAAS,EAAEX,IAAI,CAAC/B,GAAG,CAAC,CAAC;YACrBwJ,MAAM,EAAE;UACV,CAAC;UAED,MAAMC,qBAAY,CAACC,OAAO,CACxB,oBAAoBzJ,SAAS,CAACqB,EAAE,EAAE,EAClCqI,IAAI,CAACC,SAAS,CAACL,QAAQ,CACzB,CAAC;QACH,CAAC,CAAC,OAAOhJ,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;QAC1D;MACF,CAAC;MAAA,SAhBaC,kBAAkBA,CAAAqJ,IAAA;QAAA,OAAAP,mBAAA,CAAAvI,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAlBR,kBAAkB;IAAA;EAAA;IAAAjB,GAAA;IAAAC,KAAA;MAAA,IAAAsK,sBAAA,OAAApK,kBAAA,CAAAR,OAAA,EAkBhC,WAAoCiC,YAAgC,EAAiB;QACnF,IAAI;UACF,IAAMoI,QAAQ,GAAG;YACfnB,IAAI,EAAE,qBAAqB;YAC3BjH,YAAY,EAAZA,YAAY;YACZuB,SAAS,EAAEX,IAAI,CAAC/B,GAAG,CAAC,CAAC;YACrBwJ,MAAM,EAAE;UACV,CAAC;UAED,MAAMC,qBAAY,CAACC,OAAO,CACxB,uBAAuBvI,YAAY,CAACuG,cAAc,EAAE,EACpDiC,IAAI,CAACC,SAAS,CAACL,QAAQ,CACzB,CAAC;QACH,CAAC,CAAC,OAAOhJ,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;QAC7D;MACF,CAAC;MAAA,SAhBaiB,qBAAqBA,CAAAuI,IAAA;QAAA,OAAAD,sBAAA,CAAA/I,KAAA,OAAAC,SAAA;MAAA;MAAA,OAArBQ,qBAAqB;IAAA;EAAA;IAAAjC,GAAA;IAAAC,KAAA;MAAA,IAAAwK,gBAAA,OAAAtK,kBAAA,CAAAR,OAAA,EAkBnC,WAA8B+K,WAAgB,EAAiB;QAC7D,IAAI;UACF,IAAMC,SAAS,GAAGP,IAAI,CAACC,SAAS,CAACK,WAAW,CAAC;UAC7C,MAAMrM,WAAW,CAACuM,YAAY,CAC5B,eAAeF,WAAW,CAAChK,SAAS,CAACqB,EAAE,EAAE,EACzC4I,SACF,CAAC;QACH,CAAC,CAAC,OAAO3J,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;QACrD;MACF,CAAC;MAAA,SAVa4D,eAAeA,CAAAiG,IAAA;QAAA,OAAAJ,gBAAA,CAAAjJ,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAfmD,eAAe;IAAA;EAAA;IAAA5E,GAAA;IAAAC,KAAA;MAAA,IAAA6K,mBAAA,OAAA3K,kBAAA,CAAAR,OAAA,EAY7B,WAAiCyJ,WAAmB,EAAqB;QAEvE,OAAO,CACL,+BAA+B,IAAI5G,IAAI,CAAC,CAAC,CAACuI,WAAW,CAAC,CAAC,EAAE,EACzD,iBAAiB3B,WAAW,EAAE,EAC9B,8BAA8B,EAC9B,+DAA+D,CAChE;MACH,CAAC;MAAA,SARazE,kBAAkBA,CAAAqG,IAAA;QAAA,OAAAF,mBAAA,CAAAtJ,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAlBkD,kBAAkB;IAAA;EAAA;IAAA3E,GAAA;IAAAC,KAAA,EAtoBhC,SAAcgL,WAAWA,CAAA,EAA0B;MACjD,IAAI,CAACxL,qBAAqB,CAACyL,QAAQ,EAAE;QACnCzL,qBAAqB,CAACyL,QAAQ,GAAG,IAAIzL,qBAAqB,CAAC,CAAC;MAC9D;MACA,OAAOA,qBAAqB,CAACyL,QAAQ;IACvC;EAAC;AAAA;AAAA,IAAAC,QAAA,GAAA3M,OAAA,CAAAmB,OAAA,GA6oBYF,qBAAqB,CAACwL,WAAW,CAAC,CAAC","ignoreList":[]}