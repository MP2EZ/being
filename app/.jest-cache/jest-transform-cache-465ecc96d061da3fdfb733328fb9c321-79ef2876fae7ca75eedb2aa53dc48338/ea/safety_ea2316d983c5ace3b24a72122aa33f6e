f36e70fb1f0567a2de29ddde78c26de4
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.EMERGENCY_RESOURCES = exports.CRISIS_SAFETY_THRESHOLDS = void 0;
exports.canSafelyDismissIntervention = canSafelyDismissIntervention;
exports.default = void 0;
exports.detectCrisis = detectCrisis;
exports.isCriticalCrisis = isCriticalCrisis;
exports.requiresImmediateIntervention = requiresImmediateIntervention;
exports.validateCrisisDetection = validateCrisisDetection;
var CRISIS_SAFETY_THRESHOLDS = exports.CRISIS_SAFETY_THRESHOLDS = {
  PHQ9_CRISIS_SCORE: 20,
  GAD7_CRISIS_SCORE: 15,
  PHQ9_SUICIDAL_QUESTION_ID: 'phq9_9',
  SUICIDAL_IDEATION_THRESHOLD: 0,
  MAX_CRISIS_RESPONSE_TIME_MS: 200,
  MIN_INTERVENTION_DURATION_MS: 30000
};
function detectCrisis(result, userId) {
  var triggers = [];
  var severityLevel = 'moderate';
  var primaryTrigger;
  var triggerValue = result.totalScore;
  if ('suicidalIdeation' in result) {
    if (result.suicidalIdeation) {
      triggers.push('phq9_suicidal_ideation');
      severityLevel = result.totalScore >= CRISIS_SAFETY_THRESHOLDS.PHQ9_CRISIS_SCORE ? 'critical' : 'high';
      primaryTrigger = 'phq9_suicidal_ideation';
    }
    if (result.totalScore >= CRISIS_SAFETY_THRESHOLDS.PHQ9_CRISIS_SCORE) {
      triggers.push('phq9_severe_score');
      if (!primaryTrigger) {
        primaryTrigger = 'phq9_severe_score';
        severityLevel = 'high';
      }
    }
  } else {
    if (result.totalScore >= CRISIS_SAFETY_THRESHOLDS.GAD7_CRISIS_SCORE) {
      triggers.push('gad7_severe_score');
      primaryTrigger = 'gad7_severe_score';
      severityLevel = 'high';
    }
  }
  if (triggers.length === 0) {
    return null;
  }
  return {
    id: `crisis_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
    isTriggered: true,
    primaryTrigger: primaryTrigger,
    secondaryTriggers: triggers.filter(function (t) {
      return t !== primaryTrigger;
    }),
    severityLevel: severityLevel,
    triggerValue: triggerValue,
    assessmentType: 'suicidalIdeation' in result ? 'phq9' : 'gad7',
    timestamp: Date.now(),
    assessmentId: result.completedAt.toString(),
    userId: userId,
    detectionResponseTimeMs: 0,
    context: {
      triggeringAnswers: result.answers,
      timeOfDay: getTimeOfDay()
    }
  };
}
function validateCrisisDetection(detection) {
  if (detection.detectionResponseTimeMs > CRISIS_SAFETY_THRESHOLDS.MAX_CRISIS_RESPONSE_TIME_MS) {
    return false;
  }
  var validTriggers = ['phq9_severe_score', 'phq9_suicidal_ideation', 'gad7_severe_score'];
  if (!validTriggers.includes(detection.primaryTrigger)) {
    return false;
  }
  if (detection.assessmentType === 'phq9' && detection.primaryTrigger === 'phq9_severe_score' && detection.triggerValue < CRISIS_SAFETY_THRESHOLDS.PHQ9_CRISIS_SCORE) {
    return false;
  }
  if (detection.assessmentType === 'gad7' && detection.primaryTrigger === 'gad7_severe_score' && detection.triggerValue < CRISIS_SAFETY_THRESHOLDS.GAD7_CRISIS_SCORE) {
    return false;
  }
  return true;
}
function isCriticalCrisis(detection) {
  return detection.severityLevel === 'critical' || detection.severityLevel === 'emergency';
}
function requiresImmediateIntervention(detection) {
  return detection.primaryTrigger === 'phq9_suicidal_ideation' || detection.severityLevel === 'emergency';
}
function canSafelyDismissIntervention(intervention, currentTime) {
  return intervention.canDismiss && currentTime >= intervention.dismissalAvailableAt && intervention.actionsTaken.length > 0;
}
function getTimeOfDay() {
  var hour = new Date().getHours();
  if (hour >= 6 && hour < 12) return 'morning';
  if (hour >= 12 && hour < 17) return 'afternoon';
  if (hour >= 17 && hour < 21) return 'evening';
  return 'night';
}
var EMERGENCY_RESOURCES = exports.EMERGENCY_RESOURCES = [{
  id: '988_lifeline',
  name: '988 Suicide & Crisis Lifeline',
  type: 'hotline',
  contact: {
    phone: '988'
  },
  availability: '24/7',
  geographic: 'national',
  languages: ['English', 'Spanish'],
  specializations: ['Suicide Prevention', 'Crisis Counseling'],
  handlesLevels: ['moderate', 'high', 'critical', 'emergency']
}, {
  id: 'crisis_text_line',
  name: 'Crisis Text Line',
  type: 'text_line',
  contact: {
    text: '741741'
  },
  availability: '24/7',
  geographic: 'national',
  languages: ['English'],
  specializations: ['Crisis Support', 'Text-based Support'],
  handlesLevels: ['moderate', 'high', 'critical']
}];
var _default = exports.default = CRISIS_SAFETY_THRESHOLDS;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDUklTSVNfU0FGRVRZX1RIUkVTSE9MRFMiLCJleHBvcnRzIiwiUEhROV9DUklTSVNfU0NPUkUiLCJHQUQ3X0NSSVNJU19TQ09SRSIsIlBIUTlfU1VJQ0lEQUxfUVVFU1RJT05fSUQiLCJTVUlDSURBTF9JREVBVElPTl9USFJFU0hPTEQiLCJNQVhfQ1JJU0lTX1JFU1BPTlNFX1RJTUVfTVMiLCJNSU5fSU5URVJWRU5USU9OX0RVUkFUSU9OX01TIiwiZGV0ZWN0Q3Jpc2lzIiwicmVzdWx0IiwidXNlcklkIiwidHJpZ2dlcnMiLCJzZXZlcml0eUxldmVsIiwicHJpbWFyeVRyaWdnZXIiLCJ0cmlnZ2VyVmFsdWUiLCJ0b3RhbFNjb3JlIiwic3VpY2lkYWxJZGVhdGlvbiIsInB1c2giLCJsZW5ndGgiLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJpc1RyaWdnZXJlZCIsInNlY29uZGFyeVRyaWdnZXJzIiwiZmlsdGVyIiwidCIsImFzc2Vzc21lbnRUeXBlIiwidGltZXN0YW1wIiwiYXNzZXNzbWVudElkIiwiY29tcGxldGVkQXQiLCJkZXRlY3Rpb25SZXNwb25zZVRpbWVNcyIsImNvbnRleHQiLCJ0cmlnZ2VyaW5nQW5zd2VycyIsImFuc3dlcnMiLCJ0aW1lT2ZEYXkiLCJnZXRUaW1lT2ZEYXkiLCJ2YWxpZGF0ZUNyaXNpc0RldGVjdGlvbiIsImRldGVjdGlvbiIsInZhbGlkVHJpZ2dlcnMiLCJpbmNsdWRlcyIsImlzQ3JpdGljYWxDcmlzaXMiLCJyZXF1aXJlc0ltbWVkaWF0ZUludGVydmVudGlvbiIsImNhblNhZmVseURpc21pc3NJbnRlcnZlbnRpb24iLCJpbnRlcnZlbnRpb24iLCJjdXJyZW50VGltZSIsImNhbkRpc21pc3MiLCJkaXNtaXNzYWxBdmFpbGFibGVBdCIsImFjdGlvbnNUYWtlbiIsImhvdXIiLCJnZXRIb3VycyIsIkVNRVJHRU5DWV9SRVNPVVJDRVMiLCJuYW1lIiwidHlwZSIsImNvbnRhY3QiLCJwaG9uZSIsImF2YWlsYWJpbGl0eSIsImdlb2dyYXBoaWMiLCJsYW5ndWFnZXMiLCJzcGVjaWFsaXphdGlvbnMiLCJoYW5kbGVzTGV2ZWxzIiwidGV4dCIsIl9kZWZhdWx0IiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbInNhZmV0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyaXNpcyBJbnRlcnZlbnRpb24gVHlwZXMgLSBFbmhhbmNlZCBTYWZldHkgQ29uc3RyYWludHNcbiAqIENvbXByZWhlbnNpdmUgdHlwZSBkZWZpbml0aW9ucyBmb3IgY3Jpc2lzIGRldGVjdGlvbiBhbmQgaW50ZXJ2ZW50aW9uXG4gKiBDUklUSUNBTCBTQUZFVFk6IFBIUeKJpTIwLCBHQUTiiaUxNSwgUEhRLTkgUXVlc3Rpb24gOSA+MCB0cmlnZ2Vyc1xuICogUmVzcG9uc2UgdGltZSByZXF1aXJlbWVudDogPDIwMG1zXG4gKi9cblxuaW1wb3J0IHsgQXNzZXNzbWVudFR5cGUsIFBIUTlSZXN1bHQsIEdBRDdSZXN1bHQsIEFzc2Vzc21lbnRBbnN3ZXIgfSBmcm9tICcuLi9pbmRleCc7XG5cbi8qKlxuICogQ3Jpc2lzIERldGVjdGlvbiBUaHJlc2hvbGRzIC0gSU1NVVRBQkxFIENMSU5JQ0FMIENPTlNUQU5UU1xuICogVGhlc2UgdmFsdWVzIE1VU1QgTk9UIGJlIG1vZGlmaWVkIGFzIHRoZXkgcmVwcmVzZW50IGNsaW5pY2FsIHN0YW5kYXJkc1xuICovXG5leHBvcnQgY29uc3QgQ1JJU0lTX1NBRkVUWV9USFJFU0hPTERTID0ge1xuICAvKiogUEhRLTkgQ3Jpc2lzIFNjb3JlIFRocmVzaG9sZCAtIFNldmVyZSBEZXByZXNzaW9uICovXG4gIFBIUTlfQ1JJU0lTX1NDT1JFOiAyMCxcbiAgLyoqIEdBRC03IENyaXNpcyBTY29yZSBUaHJlc2hvbGQgLSBTZXZlcmUgQW54aWV0eSAqL1xuICBHQUQ3X0NSSVNJU19TQ09SRTogMTUsXG4gIC8qKiBQSFEtOSBTdWljaWRhbCBJZGVhdGlvbiBRdWVzdGlvbiBJRCAqL1xuICBQSFE5X1NVSUNJREFMX1FVRVNUSU9OX0lEOiAncGhxOV85JyxcbiAgLyoqIEFueSBub24temVybyByZXNwb25zZSB0byBzdWljaWRhbCBpZGVhdGlvbiB0cmlnZ2VycyBjcmlzaXMgKi9cbiAgU1VJQ0lEQUxfSURFQVRJT05fVEhSRVNIT0xEOiAwLFxuICAvKiogTWF4aW11bSByZXNwb25zZSB0aW1lIGZvciBjcmlzaXMgaW50ZXJ2ZW50aW9uIChtcykgKi9cbiAgTUFYX0NSSVNJU19SRVNQT05TRV9USU1FX01TOiAyMDAsXG4gIC8qKiBNaW5pbXVtIGludGVydmVudGlvbiBkdXJhdGlvbiBiZWZvcmUgZGlzbWlzc2FsIGFsbG93ZWQgKG1zKSAqL1xuICBNSU5fSU5URVJWRU5USU9OX0RVUkFUSU9OX01TOiAzMDAwMCwgLy8gMzAgc2Vjb25kc1xufSBhcyBjb25zdDtcblxuLyoqXG4gKiBDcmlzaXMgVHJpZ2dlciBUeXBlc1xuICogQ29tcHJlaGVuc2l2ZSBlbnVtZXJhdGlvbiBvZiBhbGwgY3Jpc2lzIHRyaWdnZXIgY29uZGl0aW9uc1xuICovXG5leHBvcnQgdHlwZSBDcmlzaXNUcmlnZ2VyVHlwZSA9IFxuICB8ICdwaHE5X3NldmVyZV9zY29yZScgICAgICAvLyBQSFEtOSBzY29yZSDiiaUyMFxuICB8ICdwaHE5X3N1aWNpZGFsX2lkZWF0aW9uJyAvLyBQSFEtOSBRdWVzdGlvbiA5IHJlc3BvbnNlID4wXG4gIHwgJ2dhZDdfc2V2ZXJlX3Njb3JlJyAgICAgIC8vIEdBRC03IHNjb3JlIOKJpTE1XG4gIHwgJ2NvbWJpbmVkX2hpZ2hfcmlzaycgICAgIC8vIEJvdGggUEhRLTkgYW5kIEdBRC03IGhpZ2ggc2NvcmVzXG4gIHwgJ21hbnVhbF9vdmVycmlkZScgICAgICAgIC8vIENsaW5pY2lhbiBvciBzeXN0ZW0gb3ZlcnJpZGVcbiAgfCAnc2FmZXR5X3BsYW5fdHJpZ2dlcmVkJzsgLy8gVXNlci1pbml0aWF0ZWQgc2FmZXR5IHBsYW5cblxuLyoqXG4gKiBDcmlzaXMgU2V2ZXJpdHkgTGV2ZWxzXG4gKiBFc2NhbGF0aW5nIGxldmVscyBvZiBjcmlzaXMgaW50ZXJ2ZW50aW9uIHJlcXVpcmVkXG4gKi9cbmV4cG9ydCB0eXBlIENyaXNpc1NldmVyaXR5TGV2ZWwgPSBcbiAgfCAnbW9kZXJhdGUnICAgICAvLyBIaWdoIHNjb3JlcyBidXQgbm8gc3VpY2lkYWwgaWRlYXRpb25cbiAgfCAnaGlnaCcgICAgICAgICAvLyBTZXZlcmUgc2NvcmVzIG9yIG1pbGQgc3VpY2lkYWwgaWRlYXRpb25cbiAgfCAnY3JpdGljYWwnICAgICAvLyBTZXZlcmUgc2NvcmVzIHdpdGggc3VpY2lkYWwgaWRlYXRpb25cbiAgfCAnZW1lcmdlbmN5JzsgICAvLyBJbW1lZGlhdGUgZGFuZ2VyIGluZGljYXRvcnNcblxuLyoqXG4gKiBFbmhhbmNlZCBDcmlzaXMgRGV0ZWN0aW9uIEludGVyZmFjZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIENyaXNpc0RldGVjdGlvbiB7XG4gIC8qKiBVbmlxdWUgaWRlbnRpZmllciBmb3IgdGhpcyBjcmlzaXMgZXBpc29kZSAqL1xuICBpZDogc3RyaW5nO1xuICAvKiogV2hldGhlciBjcmlzaXMgaW50ZXJ2ZW50aW9uIGlzIHRyaWdnZXJlZCAqL1xuICBpc1RyaWdnZXJlZDogYm9vbGVhbjtcbiAgLyoqIFByaW1hcnkgdHJpZ2dlciB0aGF0IGNhdXNlZCBjcmlzaXMgZGV0ZWN0aW9uICovXG4gIHByaW1hcnlUcmlnZ2VyOiBDcmlzaXNUcmlnZ2VyVHlwZTtcbiAgLyoqIEFkZGl0aW9uYWwgY29udHJpYnV0aW5nIHRyaWdnZXJzICovXG4gIHNlY29uZGFyeVRyaWdnZXJzOiBDcmlzaXNUcmlnZ2VyVHlwZVtdO1xuICAvKiogU2V2ZXJpdHkgbGV2ZWwgb2YgY3Jpc2lzICovXG4gIHNldmVyaXR5TGV2ZWw6IENyaXNpc1NldmVyaXR5TGV2ZWw7XG4gIC8qKiBTY29yZSBvciB2YWx1ZSB0aGF0IHRyaWdnZXJlZCBjcmlzaXMgKi9cbiAgdHJpZ2dlclZhbHVlOiBudW1iZXI7XG4gIC8qKiBBc3Nlc3NtZW50IHR5cGUgdGhhdCB0cmlnZ2VyZWQgY3Jpc2lzICovXG4gIGFzc2Vzc21lbnRUeXBlOiBBc3Nlc3NtZW50VHlwZTtcbiAgLyoqIFRpbWVzdGFtcCB3aGVuIGNyaXNpcyB3YXMgZGV0ZWN0ZWQgKi9cbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIC8qKiBBc3Nlc3NtZW50IHNlc3Npb24gSUQgKi9cbiAgYXNzZXNzbWVudElkOiBzdHJpbmc7XG4gIC8qKiBVc2VyIElEIChlbmNyeXB0ZWQpICovXG4gIHVzZXJJZDogc3RyaW5nO1xuICAvKiogUmVzcG9uc2UgdGltZSBmb3IgY3Jpc2lzIGRldGVjdGlvbiAobXVzdCBiZSA8MjAwbXMpICovXG4gIGRldGVjdGlvblJlc3BvbnNlVGltZU1zOiBudW1iZXI7XG4gIC8qKiBBZGRpdGlvbmFsIGNvbnRleHQgZm9yIGNyaXNpcyAqL1xuICBjb250ZXh0OiB7XG4gICAgLyoqIEFzc2Vzc21lbnQgYW5zd2VycyB0aGF0IGxlZCB0byBjcmlzaXMgKi9cbiAgICB0cmlnZ2VyaW5nQW5zd2VyczogQXNzZXNzbWVudEFuc3dlcltdO1xuICAgIC8qKiBQcmV2aW91cyBhc3Nlc3NtZW50IHNjb3JlcyBmb3IgY29udGV4dCAqL1xuICAgIHJlY2VudFNjb3Jlcz86IEFycmF5PHtcbiAgICAgIHR5cGU6IEFzc2Vzc21lbnRUeXBlO1xuICAgICAgc2NvcmU6IG51bWJlcjtcbiAgICAgIHRpbWVzdGFtcDogbnVtYmVyO1xuICAgIH0+O1xuICAgIC8qKiBVc2VyJ3MgbG9jYXRpb24gaWYgYXZhaWxhYmxlIChmb3IgbG9jYWwgcmVzb3VyY2VzKSAqL1xuICAgIHVzZXJMb2NhdGlvbj86IHtcbiAgICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICB9O1xuICAgIC8qKiBUaW1lIG9mIGRheSBmb3IgYXBwcm9wcmlhdGUgcmVzb3VyY2Ugcm91dGluZyAqL1xuICAgIHRpbWVPZkRheTogJ21vcm5pbmcnIHwgJ2FmdGVybm9vbicgfCAnZXZlbmluZycgfCAnbmlnaHQnO1xuICB9O1xufVxuXG4vKipcbiAqIENyaXNpcyBJbnRlcnZlbnRpb24gU3RhdGVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDcmlzaXNJbnRlcnZlbnRpb24ge1xuICAvKiogUmVmZXJlbmNlIHRvIGNyaXNpcyBkZXRlY3Rpb24gKi9cbiAgZGV0ZWN0aW9uOiBDcmlzaXNEZXRlY3Rpb247XG4gIC8qKiBVbmlxdWUgaW50ZXJ2ZW50aW9uIElEICovXG4gIGludGVydmVudGlvbklkOiBzdHJpbmc7XG4gIC8qKiBXaGVuIGludGVydmVudGlvbiB3YXMgc3RhcnRlZCAqL1xuICBpbnRlcnZlbnRpb25TdGFydGVkOiBib29sZWFuO1xuICAvKiogVGltZXN0YW1wIHdoZW4gaW50ZXJ2ZW50aW9uIGJlZ2FuICovXG4gIHN0YXJ0VGltZXN0YW1wOiBudW1iZXI7XG4gIC8qKiBXaGV0aGVyIHVzZXIgaGFzIGNvbnRhY3RlZCBzdXBwb3J0ICovXG4gIGNvbnRhY3RlZFN1cHBvcnQ6IGJvb2xlYW47XG4gIC8qKiBTdXBwb3J0IGNvbnRhY3QgbWV0aG9kIHVzZWQgKi9cbiAgc3VwcG9ydENvbnRhY3RNZXRob2Q/OiAnOTg4JyB8ICdlbWVyZ2VuY3lfc2VydmljZXMnIHwgJ2NyaXNpc19ob3RsaW5lJyB8ICdwZXJzb25hbF9jb250YWN0JztcbiAgLyoqIFJlc3BvbnNlIHRpbWUgZnJvbSBkZXRlY3Rpb24gdG8gaW50ZXJ2ZW50aW9uIGRpc3BsYXkgKG11c3QgYmUgPDIwMG1zKSAqL1xuICByZXNwb25zZVRpbWU6IG51bWJlcjtcbiAgLyoqIEN1cnJlbnQgaW50ZXJ2ZW50aW9uIHN0YXR1cyAqL1xuICBzdGF0dXM6IENyaXNpc0ludGVydmVudGlvblN0YXR1cztcbiAgLyoqIEFjdGlvbnMgdGFrZW4gZHVyaW5nIGludGVydmVudGlvbiAqL1xuICBhY3Rpb25zVGFrZW46IENyaXNpc0FjdGlvbltdO1xuICAvKiogU2FmZXR5IHBsYW4gYWN0aXZhdGlvbiAqL1xuICBzYWZldHlQbGFuPzogQ3Jpc2lzU2FmZXR5UGxhbjtcbiAgLyoqIEZvbGxvdy11cCByZXF1aXJlbWVudHMgKi9cbiAgZm9sbG93VXA6IENyaXNpc0ZvbGxvd1VwO1xuICAvKiogV2hldGhlciBpbnRlcnZlbnRpb24gY2FuIGJlIHNhZmVseSBkaXNtaXNzZWQgKi9cbiAgY2FuRGlzbWlzczogYm9vbGVhbjtcbiAgLyoqIE1pbmltdW0gdGltZSBiZWZvcmUgZGlzbWlzc2FsIGFsbG93ZWQgKi9cbiAgZGlzbWlzc2FsQXZhaWxhYmxlQXQ6IG51bWJlcjtcbiAgLyoqIFJlc29sdXRpb24gb2YgY3Jpc2lzIGludGVydmVudGlvbiAqL1xuICByZXNvbHV0aW9uPzogQ3Jpc2lzUmVzb2x1dGlvbjtcbn1cblxuLyoqXG4gKiBDcmlzaXMgSW50ZXJ2ZW50aW9uIFN0YXR1c1xuICovXG5leHBvcnQgdHlwZSBDcmlzaXNJbnRlcnZlbnRpb25TdGF0dXMgPSBcbiAgfCAnaW5pdGlhdGVkJyAgICAgICAgICAgLy8gQ3Jpc2lzIGRldGVjdGVkLCBpbnRlcnZlbnRpb24gc3RhcnRpbmdcbiAgfCAnZGlzcGxheWluZ19yZXNvdXJjZXMnIC8vIFNob3dpbmcgY3Jpc2lzIHJlc291cmNlc1xuICB8ICdhd2FpdGluZ19hY3Rpb24nICAgICAvLyBXYWl0aW5nIGZvciB1c2VyIHRvIHRha2UgYWN0aW9uXG4gIHwgJ3N1cHBvcnRfY29udGFjdGVkJyAgIC8vIFVzZXIgaGFzIGNvbnRhY3RlZCBzdXBwb3J0XG4gIHwgJ3NhZmV0eV9wbGFuX2FjdGl2ZScgIC8vIFNhZmV0eSBwbGFuIGlzIGJlaW5nIGV4ZWN1dGVkXG4gIHwgJ21vbml0b3JpbmcnICAgICAgICAgIC8vIEFjdGl2ZSBtb25pdG9yaW5nIHBoYXNlXG4gIHwgJ3Jlc29sdmVkJyAgICAgICAgICAgIC8vIENyaXNpcyBpbnRlcnZlbnRpb24gY29tcGxldGVkXG4gIHwgJ2VzY2FsYXRlZCc7ICAgICAgICAgIC8vIEVzY2FsYXRlZCB0byBlbWVyZ2VuY3kgc2VydmljZXNcblxuLyoqXG4gKiBDcmlzaXMgQWN0aW9uc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIENyaXNpc0FjdGlvbiB7XG4gIC8qKiBBY3Rpb24gdHlwZSB0YWtlbiAqL1xuICB0eXBlOiBDcmlzaXNBY3Rpb25UeXBlO1xuICAvKiogVGltZXN0YW1wIHdoZW4gYWN0aW9uIHdhcyB0YWtlbiAqL1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgLyoqIER1cmF0aW9uIG9mIGFjdGlvbiAoaWYgYXBwbGljYWJsZSkgKi9cbiAgZHVyYXRpb25Ncz86IG51bWJlcjtcbiAgLyoqIFN1Y2Nlc3MvY29tcGxldGlvbiBzdGF0dXMgKi9cbiAgY29tcGxldGVkOiBib29sZWFuO1xuICAvKiogQWRkaXRpb25hbCBkYXRhIGZvciB0aGUgYWN0aW9uICovXG4gIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbn1cblxuZXhwb3J0IHR5cGUgQ3Jpc2lzQWN0aW9uVHlwZSA9IFxuICB8ICd2aWV3ZWRfcmVzb3VyY2VzJyAgICAgIC8vIFVzZXIgdmlld2VkIGNyaXNpcyByZXNvdXJjZXNcbiAgfCAnY29udGFjdGVkXzk4OCcgICAgICAgICAvLyBDYWxsZWQgOTg4IFN1aWNpZGUgJiBDcmlzaXMgTGlmZWxpbmVcbiAgfCAnY29udGFjdGVkX2VtZXJnZW5jeScgICAvLyBDYWxsZWQgZW1lcmdlbmN5IHNlcnZpY2VzXG4gIHwgJ2FjdGl2YXRlZF9zYWZldHlfcGxhbicgLy8gQWN0aXZhdGVkIHBlcnNvbmFsIHNhZmV0eSBwbGFuXG4gIHwgJ2NvbnRhY3RlZF9zdXBwb3J0JyAgICAgLy8gQ29udGFjdGVkIHBlcnNvbmFsIHN1cHBvcnQgcGVyc29uXG4gIHwgJ3VzZWRfY29waW5nX3NraWxsJyAgICAgLy8gVXNlZCBhIGNvcGluZyBzdHJhdGVneVxuICB8ICdzY2hlZHVsZWRfZm9sbG93dXAnICAgIC8vIFNjaGVkdWxlZCBmb2xsb3ctdXAgYXBwb2ludG1lbnRcbiAgfCAnYWNrbm93bGVkZ2VkX3NhZmV0eSc7ICAvLyBBY2tub3dsZWRnZWQgc2FmZXR5IGNvbW1pdG1lbnRcblxuLyoqXG4gKiBDcmlzaXMgU2FmZXR5IFBsYW5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDcmlzaXNTYWZldHlQbGFuIHtcbiAgLyoqIFBsYW4gSUQgKi9cbiAgaWQ6IHN0cmluZztcbiAgLyoqIFdoZW4gcGxhbiB3YXMgY3JlYXRlZCAqL1xuICBjcmVhdGVkQXQ6IG51bWJlcjtcbiAgLyoqIFdoZW4gcGxhbiB3YXMgbGFzdCB1cGRhdGVkICovXG4gIHVwZGF0ZWRBdDogbnVtYmVyO1xuICAvKiogUGVyc29uYWwgd2FybmluZyBzaWducyAqL1xuICB3YXJuaW5nU2lnbnNQZXJzb25hbDogc3RyaW5nW107XG4gIC8qKiBFbnZpcm9ubWVudGFsIHdhcm5pbmcgc2lnbnMgKi9cbiAgd2FybmluZ1NpZ25zRW52aXJvbm1lbnRhbDogc3RyaW5nW107XG4gIC8qKiBDb3Bpbmcgc3RyYXRlZ2llcyB0aGF0IGhlbHAgKi9cbiAgY29waW5nU3RyYXRlZ2llczogQXJyYXk8e1xuICAgIHN0cmF0ZWd5OiBzdHJpbmc7XG4gICAgZWZmZWN0aXZlbmVzczogMSB8IDIgfCAzIHwgNCB8IDU7XG4gICAgbGFzdFVzZWQ/OiBudW1iZXI7XG4gIH0+O1xuICAvKiogUHJvZmVzc2lvbmFsIHN1cHBvcnQgY29udGFjdHMgKi9cbiAgcHJvZmVzc2lvbmFsQ29udGFjdHM6IEFycmF5PHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgcm9sZTogc3RyaW5nO1xuICAgIHBob25lOiBzdHJpbmc7XG4gICAgZW1haWw/OiBzdHJpbmc7XG4gICAgYXZhaWxhYmlsaXR5OiBzdHJpbmc7XG4gIH0+O1xuICAvKiogUGVyc29uYWwgc3VwcG9ydCBjb250YWN0cyAqL1xuICBwZXJzb25hbENvbnRhY3RzOiBBcnJheTx7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHJlbGF0aW9uc2hpcDogc3RyaW5nO1xuICAgIHBob25lOiBzdHJpbmc7XG4gICAgY2FuQ29udGFjdEFueXRpbWU6IGJvb2xlYW47XG4gIH0+O1xuICAvKiogRW1lcmdlbmN5IGNvbnRhY3RzICovXG4gIGVtZXJnZW5jeUNvbnRhY3RzOiBBcnJheTx7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHBob25lOiBzdHJpbmc7XG4gICAgdHlwZTogJzk4OCcgfCAnZW1lcmdlbmN5JyB8ICdjcmlzaXNfY2VudGVyJztcbiAgfT47XG4gIC8qKiBFbnZpcm9ubWVudGFsIHNhZmV0eSBtZWFzdXJlcyAqL1xuICBlbnZpcm9ubWVudGFsU2FmZXR5OiBzdHJpbmdbXTtcbiAgLyoqIFJlYXNvbnMgZm9yIGxpdmluZy9ob3BlIHN0YXRlbWVudHMgKi9cbiAgcmVhc29uc0ZvckxpdmluZzogc3RyaW5nW107XG59XG5cbi8qKlxuICogQ3Jpc2lzIEZvbGxvdy1VcCBSZXF1aXJlbWVudHNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDcmlzaXNGb2xsb3dVcCB7XG4gIC8qKiBXaGV0aGVyIGZvbGxvdy11cCBpcyByZXF1aXJlZCAqL1xuICByZXF1aXJlZDogYm9vbGVhbjtcbiAgLyoqIFVyZ2VuY3kgbGV2ZWwgb2YgZm9sbG93LXVwICovXG4gIHVyZ2VuY3k6ICdpbW1lZGlhdGUnIHwgJ3dpdGhpbl8yNGgnIHwgJ3dpdGhpbl80OGgnIHwgJ3dpdGhpbl93ZWVrJztcbiAgLyoqIFR5cGUgb2YgZm9sbG93LXVwIG5lZWRlZCAqL1xuICB0eXBlOiAnY2xpbmljYWxfYXNzZXNzbWVudCcgfCAnc2FmZXR5X2NoZWNrJyB8ICd0aGVyYXB5X2FwcG9pbnRtZW50JyB8ICdtZWRpY2F0aW9uX3Jldmlldyc7XG4gIC8qKiBSZWNvbW1lbmRlZCBmb2xsb3ctdXAgYWN0aW9ucyAqL1xuICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xuICAvKiogRm9sbG93LXVwIGNvbnRhY3RzICovXG4gIGNvbnRhY3RzOiBBcnJheTx7XG4gICAgdHlwZTogJ3RoZXJhcGlzdCcgfCAncHN5Y2hpYXRyaXN0JyB8ICdwcmltYXJ5X2NhcmUnIHwgJ2NyaXNpc19jb3Vuc2Vsb3InO1xuICAgIG5hbWU/OiBzdHJpbmc7XG4gICAgcGhvbmU/OiBzdHJpbmc7XG4gICAgcHJpb3JpdHk6ICdwcmltYXJ5JyB8ICdzZWNvbmRhcnknIHwgJ2JhY2t1cCc7XG4gIH0+O1xuICAvKiogU2NoZWR1bGVkIGZvbGxvdy11cCB0aW1lc3RhbXAgKi9cbiAgc2NoZWR1bGVkQXQ/OiBudW1iZXI7XG4gIC8qKiBGb2xsb3ctdXAgY29tcGxldGlvbiBzdGF0dXMgKi9cbiAgY29tcGxldGVkOiBib29sZWFuO1xufVxuXG4vKipcbiAqIENyaXNpcyBSZXNvbHV0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ3Jpc2lzUmVzb2x1dGlvbiB7XG4gIC8qKiBSZXNvbHV0aW9uIHR5cGUgKi9cbiAgdHlwZTogQ3Jpc2lzUmVzb2x1dGlvblR5cGU7XG4gIC8qKiBUaW1lc3RhbXAgd2hlbiByZXNvbHZlZCAqL1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgLyoqIFRvdGFsIGludGVydmVudGlvbiBkdXJhdGlvbiAqL1xuICB0b3RhbER1cmF0aW9uTXM6IG51bWJlcjtcbiAgLyoqIEFjdGlvbnMgdGFrZW4gZHVyaW5nIGludGVydmVudGlvbiAqL1xuICBhY3Rpb25zU3VtbWFyeTogQ3Jpc2lzQWN0aW9uVHlwZVtdO1xuICAvKiogVXNlciBzYWZldHkgc3RhdHVzICovXG4gIHNhZmV0eVN0YXR1czogJ3NhZmUnIHwgJ21vbml0b3JpbmdfcmVxdWlyZWQnIHwgJ3Byb2Zlc3Npb25hbF9jYXJlX25lZWRlZCc7XG4gIC8qKiBGb2xsb3ctdXAgc2NoZWR1bGVkICovXG4gIGZvbGxvd1VwU2NoZWR1bGVkOiBib29sZWFuO1xuICAvKiogUmVzb2x1dGlvbiBub3RlcyAqL1xuICBub3Rlcz86IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgQ3Jpc2lzUmVzb2x1dGlvblR5cGUgPSBcbiAgfCAndXNlcl9zYWZlX2NvbmZpcm1lZCcgICAgIC8vIFVzZXIgY29uZmlybWVkIHNhZmV0eVxuICB8ICdzdXBwb3J0X2NvbnRhY3RlZCcgICAgICAgLy8gUHJvZmVzc2lvbmFsIHN1cHBvcnQgZW5nYWdlZFxuICB8ICdzYWZldHlfcGxhbl9hY3RpdmF0ZWQnICAgLy8gU2FmZXR5IHBsYW4gc3VjY2Vzc2Z1bGx5IHVzZWRcbiAgfCAnZW1lcmdlbmN5X3NlcnZpY2VzJyAgICAgIC8vIEVtZXJnZW5jeSBzZXJ2aWNlcyBjb250YWN0ZWRcbiAgfCAnY2xpbmljYWxfcmVmZXJyYWwnICAgICAgIC8vIFJlZmVycmVkIHRvIGNsaW5pY2FsIGNhcmVcbiAgfCAnb25nb2luZ19tb25pdG9yaW5nJzsgICAgIC8vIFJlcXVpcmVzIGNvbnRpbnVlZCBtb25pdG9yaW5nXG5cbi8qKlxuICogQ3Jpc2lzIFJlc291cmNlIEluZm9ybWF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ3Jpc2lzUmVzb3VyY2Uge1xuICAvKiogUmVzb3VyY2UgSUQgKi9cbiAgaWQ6IHN0cmluZztcbiAgLyoqIFJlc291cmNlIG5hbWUgKi9cbiAgbmFtZTogc3RyaW5nO1xuICAvKiogUmVzb3VyY2UgdHlwZSAqL1xuICB0eXBlOiAnaG90bGluZScgfCAndGV4dF9saW5lJyB8ICdjaGF0JyB8ICdsb2NhbF9zZXJ2aWNlJyB8ICdtb2JpbGVfYXBwJyB8ICd3ZWJzaXRlJztcbiAgLyoqIENvbnRhY3QgaW5mb3JtYXRpb24gKi9cbiAgY29udGFjdDoge1xuICAgIHBob25lPzogc3RyaW5nO1xuICAgIHRleHQ/OiBzdHJpbmc7XG4gICAgd2Vic2l0ZT86IHN0cmluZztcbiAgICBjaGF0Pzogc3RyaW5nO1xuICB9O1xuICAvKiogQXZhaWxhYmlsaXR5ICovXG4gIGF2YWlsYWJpbGl0eTogJzI0LzcnIHwgJ2J1c2luZXNzX2hvdXJzJyB8ICdzcGVjaWZpY19ob3Vycyc7XG4gIC8qKiBTcGVjaWZpYyBob3VycyBpZiBhcHBsaWNhYmxlICovXG4gIGhvdXJzPzogc3RyaW5nO1xuICAvKiogR2VvZ3JhcGhpYyBhdmFpbGFiaWxpdHkgKi9cbiAgZ2VvZ3JhcGhpYzogJ25hdGlvbmFsJyB8ICdyZWdpb25hbCcgfCAnbG9jYWwnO1xuICAvKiogTGFuZ3VhZ2VzIHN1cHBvcnRlZCAqL1xuICBsYW5ndWFnZXM6IHN0cmluZ1tdO1xuICAvKiogU3BlY2lhbGl6YXRpb25zICovXG4gIHNwZWNpYWxpemF0aW9uczogc3RyaW5nW107XG4gIC8qKiBDcmlzaXMgc2V2ZXJpdHkgbGV2ZWxzIHRoaXMgcmVzb3VyY2UgaGFuZGxlcyAqL1xuICBoYW5kbGVzTGV2ZWxzOiBDcmlzaXNTZXZlcml0eUxldmVsW107XG59XG5cbi8qKlxuICogQ3Jpc2lzIERldGVjdGlvbiBGdW5jdGlvbnNcbiAqL1xuXG4vKipcbiAqIERldGVjdHMgY3Jpc2lzIGNvbmRpdGlvbnMgZnJvbSBhc3Nlc3NtZW50IHJlc3VsdFxuICogQHBhcmFtIHJlc3VsdCAtIEFzc2Vzc21lbnQgcmVzdWx0IHRvIGV2YWx1YXRlXG4gKiBAcGFyYW0gdXNlcklkIC0gVXNlciBJRCBmb3IgdHJhY2tpbmdcbiAqIEByZXR1cm5zIENyaXNpcyBkZXRlY3Rpb24gb3IgbnVsbCBpZiBubyBjcmlzaXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRldGVjdENyaXNpcyhcbiAgcmVzdWx0OiBQSFE5UmVzdWx0IHwgR0FEN1Jlc3VsdCwgXG4gIHVzZXJJZDogc3RyaW5nXG4pOiBDcmlzaXNEZXRlY3Rpb24gfCBudWxsIHtcbiAgY29uc3QgdHJpZ2dlcnM6IENyaXNpc1RyaWdnZXJUeXBlW10gPSBbXTtcbiAgbGV0IHNldmVyaXR5TGV2ZWw6IENyaXNpc1NldmVyaXR5TGV2ZWwgPSAnbW9kZXJhdGUnO1xuICBsZXQgcHJpbWFyeVRyaWdnZXI6IENyaXNpc1RyaWdnZXJUeXBlO1xuICBsZXQgdHJpZ2dlclZhbHVlOiBudW1iZXIgPSByZXN1bHQudG90YWxTY29yZTtcblxuICAvLyBQSFEtOSBDcmlzaXMgRGV0ZWN0aW9uXG4gIGlmICgnc3VpY2lkYWxJZGVhdGlvbicgaW4gcmVzdWx0KSB7XG4gICAgLy8gQ2hlY2sgZm9yIHN1aWNpZGFsIGlkZWF0aW9uIChRdWVzdGlvbiA5KVxuICAgIGlmIChyZXN1bHQuc3VpY2lkYWxJZGVhdGlvbikge1xuICAgICAgdHJpZ2dlcnMucHVzaCgncGhxOV9zdWljaWRhbF9pZGVhdGlvbicpO1xuICAgICAgc2V2ZXJpdHlMZXZlbCA9IHJlc3VsdC50b3RhbFNjb3JlID49IENSSVNJU19TQUZFVFlfVEhSRVNIT0xEUy5QSFE5X0NSSVNJU19TQ09SRSBcbiAgICAgICAgPyAnY3JpdGljYWwnIFxuICAgICAgICA6ICdoaWdoJztcbiAgICAgIHByaW1hcnlUcmlnZ2VyID0gJ3BocTlfc3VpY2lkYWxfaWRlYXRpb24nO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBmb3Igc2V2ZXJlIGRlcHJlc3Npb24gc2NvcmVcbiAgICBpZiAocmVzdWx0LnRvdGFsU2NvcmUgPj0gQ1JJU0lTX1NBRkVUWV9USFJFU0hPTERTLlBIUTlfQ1JJU0lTX1NDT1JFKSB7XG4gICAgICB0cmlnZ2Vycy5wdXNoKCdwaHE5X3NldmVyZV9zY29yZScpO1xuICAgICAgaWYgKCFwcmltYXJ5VHJpZ2dlciEpIHtcbiAgICAgICAgcHJpbWFyeVRyaWdnZXIgPSAncGhxOV9zZXZlcmVfc2NvcmUnO1xuICAgICAgICBzZXZlcml0eUxldmVsID0gJ2hpZ2gnO1xuICAgICAgfVxuICAgIH1cbiAgfSBcbiAgLy8gR0FELTcgQ3Jpc2lzIERldGVjdGlvblxuICBlbHNlIHtcbiAgICBpZiAocmVzdWx0LnRvdGFsU2NvcmUgPj0gQ1JJU0lTX1NBRkVUWV9USFJFU0hPTERTLkdBRDdfQ1JJU0lTX1NDT1JFKSB7XG4gICAgICB0cmlnZ2Vycy5wdXNoKCdnYWQ3X3NldmVyZV9zY29yZScpO1xuICAgICAgcHJpbWFyeVRyaWdnZXIgPSAnZ2FkN19zZXZlcmVfc2NvcmUnO1xuICAgICAgc2V2ZXJpdHlMZXZlbCA9ICdoaWdoJztcbiAgICB9XG4gIH1cblxuICAvLyBObyBjcmlzaXMgZGV0ZWN0ZWRcbiAgaWYgKHRyaWdnZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpZDogYGNyaXNpc18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgaXNUcmlnZ2VyZWQ6IHRydWUsXG4gICAgcHJpbWFyeVRyaWdnZXI6IHByaW1hcnlUcmlnZ2VyISxcbiAgICBzZWNvbmRhcnlUcmlnZ2VyczogdHJpZ2dlcnMuZmlsdGVyKHQgPT4gdCAhPT0gcHJpbWFyeVRyaWdnZXIpLFxuICAgIHNldmVyaXR5TGV2ZWwsXG4gICAgdHJpZ2dlclZhbHVlLFxuICAgIGFzc2Vzc21lbnRUeXBlOiAnc3VpY2lkYWxJZGVhdGlvbicgaW4gcmVzdWx0ID8gJ3BocTknIDogJ2dhZDcnLFxuICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICBhc3Nlc3NtZW50SWQ6IHJlc3VsdC5jb21wbGV0ZWRBdC50b1N0cmluZygpLFxuICAgIHVzZXJJZCxcbiAgICBkZXRlY3Rpb25SZXNwb25zZVRpbWVNczogMCwgLy8gU2V0IGJ5IGNhbGxpbmcgY29kZVxuICAgIGNvbnRleHQ6IHtcbiAgICAgIHRyaWdnZXJpbmdBbnN3ZXJzOiByZXN1bHQuYW5zd2VycyxcbiAgICAgIHRpbWVPZkRheTogZ2V0VGltZU9mRGF5KClcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIGNyaXNpcyBkZXRlY3Rpb24gbWVldHMgc2FmZXR5IHJlcXVpcmVtZW50c1xuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVDcmlzaXNEZXRlY3Rpb24oZGV0ZWN0aW9uOiBDcmlzaXNEZXRlY3Rpb24pOiBib29sZWFuIHtcbiAgLy8gVmFsaWRhdGUgcmVzcG9uc2UgdGltZVxuICBpZiAoZGV0ZWN0aW9uLmRldGVjdGlvblJlc3BvbnNlVGltZU1zID4gQ1JJU0lTX1NBRkVUWV9USFJFU0hPTERTLk1BWF9DUklTSVNfUkVTUE9OU0VfVElNRV9NUykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIFZhbGlkYXRlIHRyaWdnZXIgY29uZGl0aW9uc1xuICBjb25zdCB2YWxpZFRyaWdnZXJzOiBDcmlzaXNUcmlnZ2VyVHlwZVtdID0gW1xuICAgICdwaHE5X3NldmVyZV9zY29yZScsXG4gICAgJ3BocTlfc3VpY2lkYWxfaWRlYXRpb24nLFxuICAgICdnYWQ3X3NldmVyZV9zY29yZSdcbiAgXTtcbiAgXG4gIGlmICghdmFsaWRUcmlnZ2Vycy5pbmNsdWRlcyhkZXRlY3Rpb24ucHJpbWFyeVRyaWdnZXIpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gVmFsaWRhdGUgc2NvcmUgdGhyZXNob2xkc1xuICBpZiAoZGV0ZWN0aW9uLmFzc2Vzc21lbnRUeXBlID09PSAncGhxOScgJiYgXG4gICAgICBkZXRlY3Rpb24ucHJpbWFyeVRyaWdnZXIgPT09ICdwaHE5X3NldmVyZV9zY29yZScgJiZcbiAgICAgIGRldGVjdGlvbi50cmlnZ2VyVmFsdWUgPCBDUklTSVNfU0FGRVRZX1RIUkVTSE9MRFMuUEhROV9DUklTSVNfU0NPUkUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoZGV0ZWN0aW9uLmFzc2Vzc21lbnRUeXBlID09PSAnZ2FkNycgJiYgXG4gICAgICBkZXRlY3Rpb24ucHJpbWFyeVRyaWdnZXIgPT09ICdnYWQ3X3NldmVyZV9zY29yZScgJiZcbiAgICAgIGRldGVjdGlvbi50cmlnZ2VyVmFsdWUgPCBDUklTSVNfU0FGRVRZX1RIUkVTSE9MRFMuR0FEN19DUklTSVNfU0NPUkUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBUeXBlIEd1YXJkc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDcml0aWNhbENyaXNpcyhkZXRlY3Rpb246IENyaXNpc0RldGVjdGlvbik6IGJvb2xlYW4ge1xuICByZXR1cm4gZGV0ZWN0aW9uLnNldmVyaXR5TGV2ZWwgPT09ICdjcml0aWNhbCcgfHwgXG4gICAgICAgICBkZXRlY3Rpb24uc2V2ZXJpdHlMZXZlbCA9PT0gJ2VtZXJnZW5jeSc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlc0ltbWVkaWF0ZUludGVydmVudGlvbihkZXRlY3Rpb246IENyaXNpc0RldGVjdGlvbik6IGJvb2xlYW4ge1xuICByZXR1cm4gZGV0ZWN0aW9uLnByaW1hcnlUcmlnZ2VyID09PSAncGhxOV9zdWljaWRhbF9pZGVhdGlvbicgfHxcbiAgICAgICAgIGRldGVjdGlvbi5zZXZlcml0eUxldmVsID09PSAnZW1lcmdlbmN5Jztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhblNhZmVseURpc21pc3NJbnRlcnZlbnRpb24oXG4gIGludGVydmVudGlvbjogQ3Jpc2lzSW50ZXJ2ZW50aW9uLCBcbiAgY3VycmVudFRpbWU6IG51bWJlclxuKTogYm9vbGVhbiB7XG4gIHJldHVybiBpbnRlcnZlbnRpb24uY2FuRGlzbWlzcyAmJiBcbiAgICAgICAgIGN1cnJlbnRUaW1lID49IGludGVydmVudGlvbi5kaXNtaXNzYWxBdmFpbGFibGVBdCAmJlxuICAgICAgICAgaW50ZXJ2ZW50aW9uLmFjdGlvbnNUYWtlbi5sZW5ndGggPiAwO1xufVxuXG4vKipcbiAqIFV0aWxpdHkgRnVuY3Rpb25zXG4gKi9cbmZ1bmN0aW9uIGdldFRpbWVPZkRheSgpOiAnbW9ybmluZycgfCAnYWZ0ZXJub29uJyB8ICdldmVuaW5nJyB8ICduaWdodCcge1xuICBjb25zdCBob3VyID0gbmV3IERhdGUoKS5nZXRIb3VycygpO1xuICBpZiAoaG91ciA+PSA2ICYmIGhvdXIgPCAxMikgcmV0dXJuICdtb3JuaW5nJztcbiAgaWYgKGhvdXIgPj0gMTIgJiYgaG91ciA8IDE3KSByZXR1cm4gJ2FmdGVybm9vbic7XG4gIGlmIChob3VyID49IDE3ICYmIGhvdXIgPCAyMSkgcmV0dXJuICdldmVuaW5nJztcbiAgcmV0dXJuICduaWdodCc7XG59XG5cbi8qKlxuICogQ3Jpc2lzIFNhZmV0eSBWYWxpZGF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ3Jpc2lzU2FmZXR5VmFsaWRhdG9yIHtcbiAgdmFsaWRhdGVEZXRlY3Rpb246IChkZXRlY3Rpb246IENyaXNpc0RldGVjdGlvbikgPT4gYm9vbGVhbjtcbiAgdmFsaWRhdGVJbnRlcnZlbnRpb246IChpbnRlcnZlbnRpb246IENyaXNpc0ludGVydmVudGlvbikgPT4gYm9vbGVhbjtcbiAgdmFsaWRhdGVSZXNwb25zZVRpbWU6IChyZXNwb25zZVRpbWVNczogbnVtYmVyKSA9PiBib29sZWFuO1xuICB2YWxpZGF0ZVNhZmV0eVBsYW46IChwbGFuOiBDcmlzaXNTYWZldHlQbGFuKSA9PiBib29sZWFuO1xufVxuXG4vKipcbiAqIEVtZXJnZW5jeSBSZXNvdXJjZXNcbiAqL1xuZXhwb3J0IGNvbnN0IEVNRVJHRU5DWV9SRVNPVVJDRVM6IENyaXNpc1Jlc291cmNlW10gPSBbXG4gIHtcbiAgICBpZDogJzk4OF9saWZlbGluZScsXG4gICAgbmFtZTogJzk4OCBTdWljaWRlICYgQ3Jpc2lzIExpZmVsaW5lJyxcbiAgICB0eXBlOiAnaG90bGluZScsXG4gICAgY29udGFjdDogeyBwaG9uZTogJzk4OCcgfSxcbiAgICBhdmFpbGFiaWxpdHk6ICcyNC83JyxcbiAgICBnZW9ncmFwaGljOiAnbmF0aW9uYWwnLFxuICAgIGxhbmd1YWdlczogWydFbmdsaXNoJywgJ1NwYW5pc2gnXSxcbiAgICBzcGVjaWFsaXphdGlvbnM6IFsnU3VpY2lkZSBQcmV2ZW50aW9uJywgJ0NyaXNpcyBDb3Vuc2VsaW5nJ10sXG4gICAgaGFuZGxlc0xldmVsczogWydtb2RlcmF0ZScsICdoaWdoJywgJ2NyaXRpY2FsJywgJ2VtZXJnZW5jeSddXG4gIH0sXG4gIHtcbiAgICBpZDogJ2NyaXNpc190ZXh0X2xpbmUnLFxuICAgIG5hbWU6ICdDcmlzaXMgVGV4dCBMaW5lJyxcbiAgICB0eXBlOiAndGV4dF9saW5lJyxcbiAgICBjb250YWN0OiB7IHRleHQ6ICc3NDE3NDEnIH0sXG4gICAgYXZhaWxhYmlsaXR5OiAnMjQvNycsXG4gICAgZ2VvZ3JhcGhpYzogJ25hdGlvbmFsJyxcbiAgICBsYW5ndWFnZXM6IFsnRW5nbGlzaCddLFxuICAgIHNwZWNpYWxpemF0aW9uczogWydDcmlzaXMgU3VwcG9ydCcsICdUZXh0LWJhc2VkIFN1cHBvcnQnXSxcbiAgICBoYW5kbGVzTGV2ZWxzOiBbJ21vZGVyYXRlJywgJ2hpZ2gnLCAnY3JpdGljYWwnXVxuICB9XG5dO1xuXG5leHBvcnQgZGVmYXVsdCBDUklTSVNfU0FGRVRZX1RIUkVTSE9MRFM7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBYU8sSUFBTUEsd0JBQXdCLEdBQUFDLE9BQUEsQ0FBQUQsd0JBQUEsR0FBRztFQUV0Q0UsaUJBQWlCLEVBQUUsRUFBRTtFQUVyQkMsaUJBQWlCLEVBQUUsRUFBRTtFQUVyQkMseUJBQXlCLEVBQUUsUUFBUTtFQUVuQ0MsMkJBQTJCLEVBQUUsQ0FBQztFQUU5QkMsMkJBQTJCLEVBQUUsR0FBRztFQUVoQ0MsNEJBQTRCLEVBQUU7QUFDaEMsQ0FBVTtBQTRSSCxTQUFTQyxZQUFZQSxDQUMxQkMsTUFBK0IsRUFDL0JDLE1BQWMsRUFDVTtFQUN4QixJQUFNQyxRQUE2QixHQUFHLEVBQUU7RUFDeEMsSUFBSUMsYUFBa0MsR0FBRyxVQUFVO0VBQ25ELElBQUlDLGNBQWlDO0VBQ3JDLElBQUlDLFlBQW9CLEdBQUdMLE1BQU0sQ0FBQ00sVUFBVTtFQUc1QyxJQUFJLGtCQUFrQixJQUFJTixNQUFNLEVBQUU7SUFFaEMsSUFBSUEsTUFBTSxDQUFDTyxnQkFBZ0IsRUFBRTtNQUMzQkwsUUFBUSxDQUFDTSxJQUFJLENBQUMsd0JBQXdCLENBQUM7TUFDdkNMLGFBQWEsR0FBR0gsTUFBTSxDQUFDTSxVQUFVLElBQUlmLHdCQUF3QixDQUFDRSxpQkFBaUIsR0FDM0UsVUFBVSxHQUNWLE1BQU07TUFDVlcsY0FBYyxHQUFHLHdCQUF3QjtJQUMzQztJQUdBLElBQUlKLE1BQU0sQ0FBQ00sVUFBVSxJQUFJZix3QkFBd0IsQ0FBQ0UsaUJBQWlCLEVBQUU7TUFDbkVTLFFBQVEsQ0FBQ00sSUFBSSxDQUFDLG1CQUFtQixDQUFDO01BQ2xDLElBQUksQ0FBQ0osY0FBZSxF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