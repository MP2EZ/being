d5aee43391c3097df4fd1a2cf49e05a9
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CHILD_STATE = void 0;
exports.useRouteCache = useRouteCache;
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var React = _interopRequireWildcard(require("react"));
var _isRecordEqual = require("./isRecordEqual.js");
var _excluded = ["state"];
var CHILD_STATE = exports.CHILD_STATE = Symbol('CHILD_STATE');
function useRouteCache(routes) {
  var cache = React.useMemo(function () {
    return {
      current: new Map()
    };
  }, []);
  cache.current = routes.reduce(function (acc, route) {
    var previous = cache.current.get(route.key);
    var state = route.state,
      routeWithoutState = (0, _objectWithoutProperties2.default)(route, _excluded);
    var proxy;
    if (previous && (0, _isRecordEqual.isRecordEqual)(previous, routeWithoutState)) {
      proxy = previous;
    } else {
      proxy = routeWithoutState;
    }
    if (process.env.NODE_ENV !== 'production') {
      for (var key in proxy) {
        var value = proxy[key];
        Object.defineProperty(proxy, key, {
          enumerable: true,
          configurable: true,
          writable: false,
          value: value
        });
      }
    }
    Object.defineProperty(proxy, CHILD_STATE, {
      enumerable: false,
      configurable: true,
      value: state
    });
    acc.set(route.key, proxy);
    return acc;
  }, new Map());
  return Array.from(cache.current.values());
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9pc1JlY29yZEVxdWFsIiwiX2V4Y2x1ZGVkIiwiQ0hJTERfU1RBVEUiLCJleHBvcnRzIiwiU3ltYm9sIiwidXNlUm91dGVDYWNoZSIsInJvdXRlcyIsImNhY2hlIiwidXNlTWVtbyIsImN1cnJlbnQiLCJNYXAiLCJyZWR1Y2UiLCJhY2MiLCJyb3V0ZSIsInByZXZpb3VzIiwiZ2V0Iiwia2V5Iiwic3RhdGUiLCJyb3V0ZVdpdGhvdXRTdGF0ZSIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllczIiLCJkZWZhdWx0IiwicHJveHkiLCJpc1JlY29yZEVxdWFsIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwidmFsdWUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsInNldCIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91c2VSb3V0ZUNhY2hlLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6W251bGxdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUNBLElBQUFBLEtBQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQUVBLElBQUFDLGNBQUEsR0FBQUQsT0FBQTtBQUErQyxJQUFBRSxTQUFBO0FBVXhDLElBQU1DLFdBQVcsR0FBQUMsT0FBQSxDQUFBRCxXQUFBLEdBQUdFLE1BQU0sQ0FBQyxhQUFhLENBQUM7QUFNekMsU0FBU0MsYUFBYUEsQ0FDM0JDLE1BQXVCLEVBQ3ZCO0VBRUEsSUFBTUMsS0FBSyxHQUFHVixLQUFLLENBQUNXLE9BQU8sQ0FBQztJQUFBLE9BQU87TUFBRUMsT0FBTyxFQUFFLElBQUlDLEdBQUcsQ0FBQztJQUFnQixDQUFDO0VBQUEsQ0FBQyxFQUFFLEVBQUUsQ0FBQztFQUU3RUgsS0FBSyxDQUFDRSxPQUFPLEdBQUdILE1BQU0sQ0FBQ0ssTUFBTSxDQUFDLFVBQUNDLEdBQUcsRUFBRUMsS0FBSyxFQUFLO0lBQzVDLElBQU1DLFFBQVEsR0FBR1AsS0FBSyxDQUFDRSxPQUFPLENBQUNNLEdBQUcsQ0FBQ0YsS0FBSyxDQUFDRyxHQUFHLENBQUM7SUFDN0MsSUFBUUMsS0FBSyxHQUEyQkosS0FBSyxDQUFyQ0ksS0FBSztNQUFLQyxpQkFBQSxPQUFBQyx5QkFBQSxDQUFBQyxPQUFBLEVBQXNCUCxLQUFLLEVBQUFaLFNBQUE7SUFFN0MsSUFBSW9CLEtBQUs7SUFFVCxJQUFJUCxRQUFRLElBQUksSUFBQVEsNEJBQWEsRUFBQ1IsUUFBUSxFQUFFSSxpQkFBaUIsQ0FBQyxFQUFFO01BRTFERyxLQUFLLEdBQUdQLFFBQVE7SUFDbEIsQ0FBQyxNQUFNO01BQ0xPLEtBQUssR0FBR0gsaUJBQWlCO0lBQzNCO0lBRUEsSUFBSUssT0FBTyxDQUFDQyxHQUFHLENBQUNDLFFBQVEsS0FBSyxZQUFZLEVBQUU7TUFHekMsS0FBSyxJQUFNVCxHQUFHLElBQUlLLEtBQUssRUFBRTtRQUV2QixJQUFNSyxLQUFLLEdBQUdMLEtBQUssQ0FBQ0wsR0FBRyxDQUFDO1FBRXhCVyxNQUFNLENBQUNDLGNBQWMsQ0FBQ1AsS0FBSyxFQUFFTCxHQUFHLEVBQUU7VUFDaENhLFVBQVUsRUFBRSxJQUFJO1VBQ2hCQyxZQUFZLEVBQUUsSUFBSTtVQUNsQkMsUUFBUSxFQUFFLEtBQUs7VUFDZkwsS0FBQSxFQUFBQTtRQUNGLENBQUMsQ0FBQztNQUNKO0lBQ0Y7SUFFQUMsTUFBTSxDQUFDQyxjQUFjLENBQUNQLEtBQUssRUFBRW5CLFdBQVcsRUFBRTtNQUN4QzJCLFVBQVUsRUFBRSxLQUFLO01BQ2pCQyxZQUFZLEVBQUUsSUFBSTtNQUNsQkosS0FBSyxFQUFFVDtJQUNULENBQUMsQ0FBQztJQUVGTCxHQUFHLENBQUNvQixHQUFHLENBQUNuQixLQUFLLENBQUNHLEdBQUcsRUFBRUssS0FBSyxDQUFDO0lBRXpCLE9BQU9ULEdBQUc7RUFDWixDQUFDLEVBQUUsSUFBSUYsR0FBRyxDQUFDLENBQWUsQ0FBQztFQUUzQixPQUFPdUIsS0FBSyxDQUFDQyxJQUFJLENBQUMzQixLQUFLLENBQUNFLE9BQU8sQ0FBQzBCLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDM0MiLCJpZ25vcmVMaXN0IjpbXX0=